<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="msapplication-tap-highlight" content="no"><style>body {
        background: #226;
        overflow: hidden;
      }

      #a {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translateX(-50%) translateY(-50%);
        background: #000;
        z-index: 2;
      }</style></head><body><canvas id="a"></canvas><script type="text/javascript">!function(t){var e={};function o(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,o),h.l=!0,h.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)o.d(s,h,function(e){return t[e]}.bind(null,h));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);var s=function(t){var e={};function o(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,o),h.l=!0,h.exports}return o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)o.d(s,h,function(e){return t[e]}.bind(null,h));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){o.r(e),o.d(e,"Randomizer",(function(){return s})),o.d(e,"generateFaction",(function(){return b})),o.d(e,"generateShip",(function(){return y}));class s{constructor(t){this.seedPosition=0,this.arrayPosition=0,this.hrCache={},this.seed=t,this.seed.length<8&&(this.seed="padding_"+this.seed),this.seed.length%2==0&&(this.seed="1"+this.seed),this.stateArray=[2972948403,3086140710,2071788248,3026137486,1411764137,2265725585,2923087685,1593177610],this.state=3234042090;for(var e=this.seed.length-1;e>=0;e--){var o=this.seed.charCodeAt(e);this.state=((this.state<<5)+this.state^o^this.state<<o%13+1^this.state>>o%17+1)>>>0,this.stateArray[e%8]^=((this.state>>9)*(this.state%16384+3427)^o)>>>0}}sr(){var t=this.seed.charCodeAt(this.seedPosition),e=this.stateArray[this.arrayPosition];return this.state=((this.state<<5)+this.state+e^t^this.state<<t%17+1^this.state>>t%13+1)>>>0,this.stateArray[this.arrayPosition]=(e>>3^e<<t%19+1^this.state%134217728*3427)>>>0,this.seedPosition=(this.seedPosition+1)%this.seed.length,this.arrayPosition=(this.arrayPosition+1)%8,this.state}hr_xorshift(t){const e=[1160605769,1424711319,876532818,1419174464];let o=1206170165;if(null==t&&(t="?/?/?/",o=3379896793),this.hrCache.hasOwnProperty(t))return this.hrCache[t];for(var s=t.length-1;s>=0;s--){const h=t.charCodeAt(s);let i=e[0]^h;i=(i^i<<11)>>>0,i=(i^i>>8)>>>0,e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=(e[3]^e[3]>>19^i)>>>0,o=3427*(o^h<<24)^e[3]}for(var h=this.seed.length-1;h>=0;h--){const t=this.seed.charCodeAt(h);let s=e[0]^t;s=(s^s<<11)>>>0,s=(s^s>>8)>>>0,e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=(e[3]^e[3]>>19^s)>>>0,o=3427*(o^t<<24)^e[3]}return this.hrCache[t]=o>>>0,this.hrCache[t]}sd(t,e){return(4294967296*this.sr()+this.sr())/0x10000000000000000*(e-t)+t}hd(t,e,o){return(4294967296*this.hr_xorshift(o)+this.hr_xorshift(o+"@"))/0x10000000000000000*(e-t)+t}si(t,e){return Math.floor((4294967296*this.sr()+this.sr())/0x10000000000000000*(e+1-t)+t)}hi(t,e,o){return Math.floor((4294967296*this.hr_xorshift(o)+this.hr_xorshift(o+"@"))/0x10000000000000000*(e+1-t)+t)}sb(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t}hb(t,e){return(4294967296*this.hr_xorshift(e)+this.hr_xorshift(e+"@"))/0x10000000000000000<t}ss(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t?-1:1}hs(t,e){return(4294967296*this.hr_xorshift(e)+this.hr_xorshift(e+"@"))/0x10000000000000000<t?-1:1}sseq(t,e){for(var o=0;(4294967296*this.sr()+this.sr())/0x10000000000000000<t&&o<e;)o++;return o}hseq(t,e,o){for(var s=0;(4294967296*this.hr_xorshift(o+s)+this.hr_xorshift(o+"@"+s))/0x10000000000000000<t&&s<e;)s++;return s}schoose(t){for(var e=0,o=0;o<t.length;o++)e+=t[o];for(var s=this.sd(0,e),h=0;h<t.length;h++)if((s-=t[h])<0)return h;return 0}hchoose(t,e){for(var o=0,s=0;s<t.length;s++)o+=t[s];for(var h=this.hd(0,o,e),i=0;i<t.length;i++)if((h-=t[i])<0)return i;return 0}}function h(t,e,o){return Math.max(e,Math.min(o,t))}function i(t,e){for(var o=Math.floor(t).toString(16);o.length<e;)o="0"+o;return o}function r(t){return"#"+i(Math.floor(255*h(t[0],0,1)),2)+(i(Math.floor(255*h(t[1],0,1)),2)+i(Math.floor(255*h(t[2],0,1)),2))}function a(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function n(t){var e=t[1]*t[2],o=t[2]-e,s=(t[0]%1+1)%1*6,h=Math.floor(s),i=e*(1-Math.abs(s%2-1));switch(h){case 0:return[e+o,i+o,o];case 1:return[i+o,e+o,o];case 2:return[o,e+o,i+o];case 3:return[o,i+o,e+o];case 4:return[i+o,o,e+o];default:return[e+o,o,i+o]}}class c{constructor(t){this.componentChances=[],this.colors=[],this.colorChances=[],this.seed=t,this.r=new s(this.seed),this.cache={},this.setupComponentChances(),this.setupColors()}setupComponentChances(){this.componentChances=[],this.componentChances[0]=.8*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[1]=.9*this.r.sd(.01,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[2]=1*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[3]=3*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[4]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[5]=.05*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[6]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8))}setupColors(){const t=1+(this.r.hb(.7,"base color +1")?1:0)+this.r.hseq(.3,3,"base color count");for(let e=0;e<t;e++){const t="base color"+e;this.colors.push(n([Math.pow(this.r.hd(0,1,t+"hue"),2),h(this.r.hd(-.2,1,t+"saturation"),0,Math.pow(this.r.hd(0,1,t+"saturation bound"),4)),h(this.r.hd(.7,1.1,t+"value"),0,1)])),this.colorChances.push(Math.pow(2,this.r.hd(0,6,t+"chances")))}}getBaseColor(t){let e=this.colors[t.r.schoose(this.colorChances)];return t.r.sb(Math.pow(this.r.hd(0,.5,"base color shift chance"),2))&&(e=[e[0],e[1],e[2]],e[0]=h(e[0]+Math.pow(this.r.hd(0,.6,"base color shift range red"),2)*h(t.r.sd(-1,1.2),0,1)*h(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),e[1]=h(e[1]+Math.pow(this.r.hd(0,.6,"base color shift range green"),2)*h(t.r.sd(-1,1.2),0,1)*h(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),e[2]=h(e[2]+Math.pow(this.r.hd(0,.6,"base color shift range blue"),2)*h(t.r.sd(-1,1.2),0,1)*h(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1)),e}}function l(t,e){return 1-e[1]/t.h}function f(t,e,o,s){let h=1;return o&&(h=Math.min(h,1-Math.abs(e[0]-t.hw)/t.hw)),s&&(h=Math.min(h,1-Math.abs(e[1]-t.hh)/t.hh)),h}function d(t,e){return f(t,e,!0,!0)*(1-1/((t.w+t.h)/1e3+1))*Math.pow(t.f.r.hd(0,1,"master bigness"),.5)*(1-t.getpcdone())}function u(t,e){return[Math.min(e[0][0]-0,t.w-0-e[1][0]),Math.min(e[0][1]-0,t.h-0-e[1][1])]}function g(t,e,o,s){const i=t.cfx.createLinearGradient(o[0],o[1],2*e[0]-o[0],2*e[1]-o[1]),r=function(t){return"rgba(0,0,0,"+h(t,0,1)+")"}(s);return i.addColorStop(0,r),i.addColorStop(.5,"rgba(0,0,0,0)"),i.addColorStop(1,r),i}const m=[];m[0]=function(t,e){let o=8;const s=Math.pow(d(t,e),.3);if(t.r.sb(t.f.r.hd(0,.9,"com0 bigchance")*s)){const h=t.f.r.hd(0,.5,"com0 bigincchance");for(;t.r.sb(h*s);){const s=u(t,[[e[0]-o,e[1]-o],[e[0]+o,e[1]+o]]);if(!(Math.min(s[0],s[1])>.5*o))break;o*=1.5}}const i=2*o,n=[Math.ceil(t.r.sd(1,Math.max(2,.5*o))),Math.ceil(t.r.sd(1,Math.max(2,.5*o)))],c=Math.min(n[0],n[1])*t.r.sd(.1,1.2),l=[n[0]+2*c,n[1]+2*c],f=[Math.ceil(i/l[0]),Math.ceil(i/l[1])],m=[Math.round(f[0]*l[0]/2),Math.round(f[1]*l[1]/2)],x=t.getpcdone(),p=t.f.getBaseColor(t),M=r(a(p,t.r.sd(.4,1))),w=r(a(p,t.r.sd(.4,1)));t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(e[0]-m[0]-1,e[1]-m[1]-1,l[0]*f[0]+2,l[1]*f[1]+2),t.cfx.fillStyle=w,t.cfx.fillRect(e[0]-m[0],e[1]-m[1],l[0]*f[0],l[1]*f[1]),t.cfx.fillStyle=M;for(let o=0;o<f[0];o++){const s=e[0]+c+o*l[0]-m[0];for(let o=0;o<f[1];o++)t.cfx.fillRect(s,e[1]+c+o*l[1]-m[1],n[0],n[1])}t.r.sb(h(o/8*(.6*x+.3),0,.98))&&(t.cfx.fillStyle=g(t,e,[e[0]+m[0],e[1]],t.r.sd(0,.9)),t.cfx.fillRect(e[0]-m[0],e[1]-m[1],l[0]*f[0],l[1]*f[1]))},m[1]=function(t,e){let o=8;const s=Math.pow(d(t,e),.2);if(t.r.sb(t.f.r.hd(.3,1,"com1 bigchance")*s)){const h=t.f.r.hd(0,.6,"com1 bigincchance");for(;t.r.sb(h*s);){const s=u(t,[[e[0]-o,e[1]-o],[e[0]+o,e[1]+o]]);if(!(Math.min(s[0],s[1])>.5*o))break;o*=1.5}}let i=Math.ceil(t.r.sd(.8,2)*o);const n=Math.ceil(t.r.sd(.8,2)*o),c=t.r.si(3,Math.max(4,i)),l=Math.max(1,Math.round(i/c));i=l*c;const f=r(a(t.f.getBaseColor(t),t.r.sd(.5,1))),m=t.r.sd(.3,.9);if(t.r.sb(h(t.f.r.hd(-.2,1.2,"com1 hchance"),0,1))){const o=[e[0]-Math.floor(i/2),e[1]-Math.floor(n/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(o[0]-1,o[1]-1,i+2,n+2),t.cfx.fillStyle=f,t.cfx.fillRect(o[0],o[1],i,n);for(let s=0;s<l;s++)t.cfx.fillStyle=g(t,[o[0]+(s+.5)*c,e[1]],[o[0]+s*c,e[1]],m),t.cfx.fillRect(o[0]+s*c,o[1],c,n)}else{const o=[e[0]-Math.floor(n/2),e[1]-Math.floor(i/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(o[0]-1,o[1]-1,n+2,i+2),t.cfx.fillStyle=f,t.cfx.fillRect(o[0],o[1],n,i);for(let s=0;s<l;s++)t.cfx.fillStyle=g(t,[e[0],o[1]+(s+.5)*c],[e[0],o[1]+s*c],m),t.cfx.fillRect(o[0],o[1]+s*c,i,c)}},m[2]=function(t,e){let o=8;const s=Math.pow(d(t,e),.05);if(t.r.sb(t.f.r.hd(0,1,"com2 bigchance")*s)){const h=t.f.r.hd(0,.9,"com2 bigincchance");for(;t.r.sb(h*s);){const s=u(t,[[e[0]-o,e[1]-o],[e[0]+o,e[1]+o]]);if(!(Math.min(s[0],s[1])>.5*o))break;o*=1.5}}const i=Math.ceil(t.r.sd(.6,1.4)*o),n=Math.ceil(t.r.sd(1,2)*o),c=[Math.ceil(h(i*t.r.sd(.7,1)/2,1,i)),Math.ceil(h(i*t.r.sd(.8,1)/2,1,i))],l=[Math.floor(h(i*t.r.sd(.05,.25),1,n)),Math.floor(h(i*t.r.sd(.1,.3),1,n))],f=l[0]+l[1],g=t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 oddchance"),.5)),m=h(Math.floor(n/f),1,n),x=m*f+(g?l[0]:0),p=t.f.getBaseColor(t),M=[a(p,t.r.sd(.6,1)),a(p,t.r.sd(.6,1))],w=1-t.r.sd(.5,.95),b=[a(M[0],w),a(M[1],w)];if(t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 verticalchance"),.1))){const o=[t.cfx.createLinearGradient(e[0]-c[0],e[1],e[0]+c[0],e[1]),t.cfx.createLinearGradient(e[0]-c[1],e[1],e[0]+c[1],e[1])];o[0].addColorStop(0,r(b[0])),o[0].addColorStop(.5,r(M[0])),o[0].addColorStop(1,r(b[0])),o[1].addColorStop(0,r(b[1])),o[1].addColorStop(.5,r(M[1])),o[1].addColorStop(1,r(b[1]));const s=Math.floor(e[1]-x/2);for(let h=0;h<m;h++)t.cfx.fillStyle=o[0],t.cfx.fillRect(e[0]-c[0],s+h*f,2*c[0],l[0]),t.cfx.fillStyle=o[1],t.cfx.fillRect(e[0]-c[1],s+h*f+l[0],2*c[1],l[1]);g&&(t.cfx.fillStyle=o[0],t.cfx.fillRect(e[0]-c[0],s+m*f,2*c[0],l[0]))}else{const o=[t.cfx.createLinearGradient(e[0],e[1]-c[0],e[0],e[1]+c[0]),t.cfx.createLinearGradient(e[0],e[1]-c[1],e[0],e[1]+c[1])];o[0].addColorStop(0,r(b[0])),o[0].addColorStop(.5,r(M[0])),o[0].addColorStop(1,r(b[0])),o[1].addColorStop(0,r(b[1])),o[1].addColorStop(.5,r(M[1])),o[1].addColorStop(1,r(b[1]));const s=Math.floor(e[0]-x/2);for(let h=0;h<m;h++)t.cfx.fillStyle=o[0],t.cfx.fillRect(s+h*f,e[1]-c[0],l[0],2*c[0]),t.cfx.fillStyle=o[1],t.cfx.fillRect(s+h*f+l[0],e[1]-c[1],l[1],2*c[1]);g&&(t.cfx.fillStyle=o[0],t.cfx.fillRect(s+m*f,e[1]-c[0],l[0],2*c[0]))}},m[3]=function(t,e){if(t.r.sb(l(t,e)-.3)||t.getcellstate(e[0],e[1]+6*1.2)>0||t.getcellstate(e[0],e[1]+10.8)>0)for(let o=0;o<100;o++){const o=t.r.schoose(t.f.componentChances);if(3!=o)return void m[o](t,e)}let o=8;const s=Math.pow(d(t,e),.1);if(t.r.sb(t.f.r.hd(.6,1,"com3 bigchance")*s)){const h=t.f.r.hd(.3,.8,"com3 bigincchance");for(;t.r.sb(h*s);){const s=u(t,[[e[0]-o,e[1]-o],[e[0]+o,e[1]+o]]);if(!(Math.min(s[0],s[1])>.5*o))break;o*=1.5}}const h=t.r.sd(1,2)*o;let i=Math.ceil(t.r.sd(.3,1)*o);const n=h*t.r.sd(.25,.6),c=(h+n)/2/2,f=[Math.max(1,Math.ceil(i*t.r.sd(.08,.25))),Math.max(1,Math.ceil(i*t.r.sd(.03,.15)))],g=f[0]+f[1],x=Math.ceil(i/g);i=x*g+f[0],t.f.setupColors();const p=t.f.colors[t.f.r.hchoose(t.f.colorChances,"com3 basecolor")],M=t.f.r.hd(.5,.8,"com3 lightness0 mid"),w=M-t.f.r.hd(.2,.4,"com3 lightness0 edge"),b=t.f.r.hd(0,.2,"com3 lightness1 edge"),y=[t.cfx.createLinearGradient(e[0]-c,e[1],e[0]+c,e[1]),t.cfx.createLinearGradient(e[0]-c,e[1],e[0]+c,e[1])];y[0].addColorStop(0,r(a(p,w))),y[0].addColorStop(.5,r(a(p,M))),y[0].addColorStop(1,r(a(p,w))),y[1].addColorStop(0,r(a(p,b))),y[1].addColorStop(.5,r(p)),y[1].addColorStop(1,r(a(p,b)));const S=Math.ceil(e[1]-i/2);t.cfx.fillStyle=y[0],t.cfx.beginPath(),t.cfx.moveTo(e[0]-n/2,S),t.cfx.lineTo(e[0]+n/2,S),t.cfx.lineTo(e[0]+h/2,S+i),t.cfx.lineTo(e[0]-h/2,S+i),t.cfx.fill(),t.cfx.fillStyle=y[1];const v=[S+f[0],S+g];for(let o=0;o<x;o++){const s=[o*g+f[0],(o+1)*g],r=[v[0]+o*g,v[1]+o*g],a=[(n+s[0]/i*(h-n))/2,(n+s[1]/i*(h-n))/2];t.cfx.beginPath(),t.cfx.moveTo(e[0]-a[0],r[0]),t.cfx.lineTo(e[0]+a[0],r[0]),t.cfx.lineTo(e[0]+a[1],r[1]),t.cfx.lineTo(e[0]-a[1],r[1]),t.cfx.fill()}},m[4]=function(t,e){const o=f(t,e,!0,!1),s=t.r.sd(.7,1),h=t.r.sd(0,.2),i=t.f.getBaseColor(t),n=r(a(i,s)),c=r(a(i,h));null==t.f.cache["com4 directionc"]&&(t.f.cache["com4 directionc"]=[1*Math.pow(t.f.r.hd(0,1,"com4 directionc0"),4),.1*Math.pow(t.f.r.hd(0,1,"com4 directionc1"),4),.2*Math.pow(t.f.r.hd(0,1,"com4 directionc2"),4)]);const l=Math.max(3,Math.ceil(t.size*Math.pow(t.r.sd(.4,1),2)*t.f.r.hd(.02,.1,"com4 maxwidth"))),d=Math.floor(l/2),u=l%2,g=t.r.schoose([t.f.cache["com4 directionc"][0]*(2-o),t.f.cache["com4 directionc"][1],t.f.cache["com4 directionc"][2]*(1+o)]);let x=null;if(0==g){const o=Math.min(Math.max(8,e[1]-0-t.r.si(0,16)),Math.floor(.7*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,6,"com4 hpower0")))),s=[[e[0]-d,e[1]-o],[e[0]+d+u,e[1]]],h=t.cfx.createLinearGradient(s[0][0],s[0][1],s[1][0],s[0][1]);h.addColorStop(0,c),h.addColorStop(.5,n),h.addColorStop(1,c),t.cfx.fillStyle=h,t.cfx.fillRect(s[0][0],s[0][1],l,o),x=[e[0],e[1]-o]}else if(1==g){const o=Math.min(Math.max(8,t.h-(0+e[1])-t.r.si(0,16)),Math.floor(.6*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,7,"com4 hpower1")))),s=[[e[0]-d,e[1]],[e[0]+d+u,e[1]+o]],h=t.cfx.createLinearGradient(s[0][0],s[0][1],s[1][0],s[0][1]);h.addColorStop(0,c),h.addColorStop(.5,n),h.addColorStop(1,c),t.cfx.fillStyle=h,t.cfx.fillRect(s[0][0],s[0][1],l,o),x=[e[0],e[1]+o]}else if(2==g){const o=t.cfx.createLinearGradient(e[0],e[1]-d,e[0],e[1]+d+u);o.addColorStop(0,c),o.addColorStop(.5,n),o.addColorStop(1,c),t.cfx.fillStyle=o,t.cfx.fillRect(e[0],e[1]-d,Math.ceil(t.hw-e[0])+1,l),x=[Math.floor(t.hw),e[1]]}if(null==t.f.cache["com4 covercomc"]&&(t.f.cache["com4 covercomc"]=[.6*Math.pow(t.f.r.hd(0,1,"com4 covercomc0"),2),.2*Math.pow(t.f.r.hd(0,1,"com4 covercomc1"),2),1*Math.pow(t.f.r.hd(0,1,"com4 covercomc2"),2)]),m[t.r.schoose(t.f.cache["com4 covercomc"])](t,e),t.getcellstate(x[0],x[1])>0){const e=[x[0]+Math.round(6*t.r.sd(-1,1)),x[1]+Math.round(6*t.r.sd(-1,1))];t.getcellstate(e[0],e[1])>0?m[t.r.schoose(t.f.cache["com4 covercomc"])](t,e):m[t.r.schoose(t.f.cache["com4 covercomc"])](t,x)}},m[5]=function(t,e){let o=8;const s=Math.pow(d(t,e),.1);if(t.r.sb(t.f.r.hd(0,.9,"com5 bigchance")*s)){const h=t.f.r.hd(0,.8,"com5 bigincchance");for(;t.r.sb(h*s);){const s=u(t,[[e[0]-o,e[1]-o],[e[0]+o,e[1]+o]]);if(!(Math.min(s[0],s[1])>.5*o))break;o*=1.5}}const h=t.r.sd(.75,1),i=t.r.sd(0,.25),n=t.f.getBaseColor(t),c=r(a(n,h)),l=r(a(n,i)),f=1+t.r.sseq(t.f.r.hd(0,1,"com5 multxc"),Math.floor(1.2*Math.pow(o/8,.6))),g=1+t.r.sseq(t.f.r.hd(0,1,"com5 multyc"),Math.floor(1.2*Math.pow(o/8,.6))),m=t.r.sd(.5,1)*o/Math.max(f,g),x=m+.5,p=m+1,M=.2*m,w=[e[0]-m*f,e[1]-m*g];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")";for(let e=0;e<f;e++){const o=w[0]+(2*e+1)*m;for(let e=0;e<g;e++){const s=w[1]+(2*e+1)*m;t.cfx.beginPath(),t.cfx.arc(o,s,p,0,2*Math.PI),t.cfx.fill()}}for(let e=0;e<f;e++){const o=w[0]+(2*e+1)*m;for(let e=0;e<g;e++){const s=w[1]+(2*e+1)*m,h=t.cfx.createRadialGradient(o,s,M,o,s,x);h.addColorStop(0,c),h.addColorStop(1,l),t.cfx.fillStyle=h,t.cfx.beginPath(),t.cfx.arc(o,s,x,0,2*Math.PI),t.cfx.fill()}}},m[6]=function(t,e){if(t.nextpass<=0||t.r.sb(l(t,e)))return void m[t.r.schoose(function(t,e,o){const s=new Array(5);for(let e=5;e>=0;e--)s[e-0]=t[e];return s}(t.f.componentChances))](t,e);let o=8;const s=Math.pow(d(t,e),.05);if(t.r.sb(t.f.r.hd(0,.9,"com6 bigchance")*s)){const h=t.f.r.hd(0,.8,"com6 bigincchance");for(;t.r.sb(h*s);){const s=u(t,[[e[0]-o,e[1]-o],[e[0]+o,e[1]+o]]);if(!(Math.min(s[0],s[1])>.5*o))break;o*=1.5}}const h=Math.ceil(2*o*t.r.sd(.6,1)),i=Math.floor(h/2),n=h%2,c=h*Math.pow(t.r.sd(Math.pow(t.f.r.hd(0,.8,"com6 h1min"),.5),.9),t.f.r.hd(.5,1.5,"com6 h1power")),f=Math.floor(c/2),g=h%2,x=Math.max(0-(h-c)/2,h*(t.r.sd(0,.45)+t.r.sd(0,.45))*(null==t.f.cache["com6 backness"]?t.f.cache["com6 backness"]=t.f.r.hb(.8,"com6 backnesstype")?t.f.r.hd(.2,.9,"com6 backness#pos"):t.f.r.hd(-.2,-.05,"com6 backness#neg"):t.f.cache["com6 backness"])),p=Math.ceil(o*t.r.sd(.7,1)*Math.pow(t.f.r.hd(.1,3.5,"com6 width"),.5)),M=Math.floor(p/2),w=p%2,b=[[e[0]-M,e[1]+x-f],[e[0]+M+w,e[1]-i],[e[0]+M+w,e[1]+i+n],[e[0]-M,e[1]+x+f+g]],y=t.f.getBaseColor(t);t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")",t.cfx.beginPath(),t.cfx.moveTo(b[0][0]-1,b[0][1]),t.cfx.lineTo(b[1][0]-1,b[1][1]),t.cfx.lineTo(b[2][0]-1,b[2][1]),t.cfx.lineTo(b[3][0]-1,b[3][1]),t.cfx.fill(),t.cfx.fillStyle=r(a(y,t.r.sd(.7,1))),t.cfx.beginPath(),t.cfx.moveTo(b[0][0],b[0][1]),t.cfx.lineTo(b[1][0],b[1][1]),t.cfx.lineTo(b[2][0],b[2][1]),t.cfx.lineTo(b[3][0],b[3][1]),t.cfx.fill()};const x=[];x[0]=function(t){for(var e=(t.w-0)*(t.h-0)*.05,o=Math.ceil((t.w-0)*t.f.r.hd(.1,1,"outline0 iw")*.2),s=[[[t.hw-o,0],[t.hw+o,t.h-0]]],i=2+Math.floor(t.r.sd(.5,1)*t.f.r.hd(2,8,"outline0 bc")*Math.sqrt(t.size)),r=1;r<i;r++){var a=s[t.r.si(0,s.length-1)],n=[a[0][0]+t.r.sd(0,1)*(a[1][0]-a[0][0]),a[0][1]+t.r.sd(0,1)*(a[1][1]-a[0][1])];n[1]<.5*(a[0][1]+a[1][1])&&t.r.sb(t.f.r.hd(.5,1.5,"outline0 frontbias"))&&(n[1]=a[1][1]-(n[1]-a[0][1]));var c=[h(t.r.sd(0,1)*t.w,0,t.w-0),h(t.r.sd(0,1)*t.h,0,t.h-0)],l=e/Math.abs((c[0]-n[0])*(c[1]-n[1]));if(l<1&&(c[0]=n[0]+(c[0]-n[0])*l,c[1]=n[1]+(c[1]-n[1])*l),n[0]>c[0]){var f=n[0];n[0]=c[0],c[0]=f}n[1]>c[1]&&(f=n[1],n[1]=c[1],c[1]=f),s.push([[Math.floor(n[0]),Math.floor(n[1])],[Math.ceil(c[0]),Math.ceil(c[1])]])}for(t.csx.fillStyle="#FFFFFF",r=0;r<s.length;r++){var d=s[r];t.csx.fillRect(d[0][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1]),t.csx.fillRect(t.w-d[1][0],d[0][1],d[1][0]-d[0][0],d[1][1]-d[0][1])}},x[1]=function(t){for(var e=Math.max(2,Math.sqrt((t.w-0)*(t.h-0)*.05/Math.PI)),o=Math.ceil((t.w-0)*t.f.r.hd(.1,1,"outline1 iw")*.2),s=[],h=Math.floor((t.h-0)/(2*o)),i=0;i<h;i++)s.push({v:[t.hw,t.h-(0+o*(2*i+1))],r:o});var r=h+Math.floor(t.r.sd(.5,1)*t.f.r.hd(10,50,"outline1 cc")*Math.sqrt(t.size));for(i=h;i<r;i++){var a=s[Math.max(t.r.si(0,s.length-1),t.r.si(0,s.length-1))],n=t.r.sd(1,e),c=t.r.sd(Math.max(0,a.r-n),a.r);if((l=t.r.sd(0,2*Math.PI))>Math.PI&&t.r.sb(t.f.r.hd(.5,1.5,"outline1 frontbias")))var l=t.r.sd(0,Math.PI);let o=[a.v[0]+Math.cos(l)*c,a.v[1]+Math.sin(l)*c];n=Math.min(n,o[0]-0),n=Math.min(n,t.w-0-o[0]),n=Math.min(n,o[1]-0),n=Math.min(n,t.h-0-o[1]),s.push({v:o,r:n})}t.csx.fillStyle="#FFFFFF";for(let e=0;e<s.length;e++){const o=s[e];t.csx.beginPath(),t.csx.arc(o.v[0],o.v[1],o.r,0,2*Math.PI),t.csx.fill(),t.csx.beginPath(),t.csx.arc(t.w-o.v[0],o.v[1],o.r,0,2*Math.PI),t.csx.fill()}},x[2]=function(t){var e=[t.w-0,t.h-0],o=[[t.hw,t.r.sd(0,.05)*e[1]+0],[t.hw,t.r.sd(.95,1)*e[1]+0]],s=6/t.size+t.f.r.hd(.03,.1,"outline2 basefatness"),h=Math.max(3,Math.ceil(1/s*t.r.sd(.05,.1)*Math.sqrt(t.size)));t.csx.lineCap=["round","square"][t.f.r.hi(0,1,"outline2 linecap")],t.csx.strokeStyle="#FFFFFF";for(var i=1;i<h;i++){var r=o[i];null==r&&(r=[t.r.sd(0,1)*e[0]+0,Math.pow(t.r.sd(0,1),t.f.r.hd(.1,1,"outline2 frontbias"))*e[1]+0],o.push(r));for(var a=1+t.r.sseq(t.f.r.hd(0,1,"outline2 conadjust"),3),n=0;n<a;n++){var c=o[t.r.si(0,o.length-2)];t.csx.lineWidth=t.r.sd(.7,1)*s*t.size,t.csx.beginPath(),t.csx.moveTo(c[0],c[1]),t.csx.lineTo(r[0],r[1]),t.csx.stroke(),t.csx.beginPath(),t.csx.moveTo(t.w-c[0],c[1]),t.csx.lineTo(t.w-r[0],r[1]),t.csx.stroke()}}};class p{constructor(t,e,o){this.extradone=0,this.nextpass=0,this.nextcell=0,this.totaldone=0,this.f=t,this.baseSeed=e,this.seed=this.f.seed+this.baseSeed,this.r=new s(this.seed),this.size=null==o?Math.pow(this.r.sd(this.f.r.hd(2.5,3.5,"size min"),this.f.r.hd(5,7,"size max")),3):o;const h=this.r.sd(this.f.r.hd(.5,1,"wratio min"),this.f.r.hd(1,1.3,"wratio max")),i=this.r.sd(this.f.r.hd(.7,1,"hratio min"),this.f.r.hd(1.1,1.7,"hratio max"));this.w=Math.floor(this.size*h)+0,this.hw=Math.floor(this.w/2),this.gw=Math.floor((this.w-0)/6),this.gwextra=.5*(this.w-6*this.gw),this.h=Math.floor(this.size*i)+0,this.hh=Math.floor(this.h/2),this.gh=Math.floor((this.h-0)/6),this.ghextra=.5*(this.h-6*this.gh),this.cs=document.createElement("canvas"),this.cs.setAttribute("width",String(this.w)),this.cs.setAttribute("height",String(this.h)),this.csx=this.cs.getContext("2d"),this.cf=document.createElement("canvas"),this.cf.setAttribute("width",String(this.w)),this.cf.setAttribute("height",String(this.h)),this.cfx=this.cf.getContext("2d"),x[this.f.r.hchoose([1,1,1],"outline type")](this),this.csd=this.csx.getImageData(0,0,this.w,this.h),this.cgrid=[];for(let t=0;t<this.gw;t++){this.cgrid[t]=[];for(let e=0;e<this.gh;e++)this.cgrid[t][e]={gx:t,gy:e,x:Math.floor(this.gwextra+6*(t+.5)),y:Math.floor(this.ghextra+6*(e+.5)),state:0}}this.goodcells=[this.cgrid[Math.floor(this.gw/2)][Math.floor(this.gh/2)]];let r=0;for(;r<this.goodcells.length;){const t=this.goodcells[r];if(t.gx>0){const e=this.cgrid[t.gx-1][t.gy];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}if(t.gx<this.gw-1){const e=this.cgrid[t.gx+1][t.gy];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}if(t.gy>0){const e=this.cgrid[t.gx][t.gy-1];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}if(t.gy<this.gh-1){const e=this.cgrid[t.gx][t.gy+1];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}r++}for(let t=0;t<this.goodcells.length;t++){const e=this.goodcells[t],o=this.cgrid[this.gw-1-e.gx][e.gy];1!=o.state&&(o.state=1,this.goodcells.push(o))}this.passes=this.f.r.hi(1,2,"base component passes"),this.extra=Math.max(1,Math.floor(this.goodcells.length*this.f.r.hd(0,1/this.passes,"extra component amount"))),this.totalcomponents=this.passes*this.goodcells.length+this.extra}getcell(t,e){const o=Math.floor((t-this.gwextra)/6),s=Math.floor((e-this.ghextra)/6);return o<0||o>=this.gw||s<0||s>=this.gh?null:this.cgrid[o][s]}getcellstate(t,e){const o=this.getcell(t,e);return null==o?0:o.state}getspa(t,e){return t=Math.floor(t),e=Math.floor(e),t<0||t>this.w||e<0||e>this.h?-1:this.csd.data[4*(e*this.w+t)+3]}getpcdone(){return this.totaldone/this.totalcomponents}addcomponent(){let t;if(this.nextpass<this.passes)this.nextcell<this.goodcells.length?(t=this.goodcells[this.nextcell],this.nextcell++):(this.nextpass++,t=this.goodcells[0],this.nextcell=1);else{if(!(this.extradone<this.extra))return!0;t=this.goodcells[this.r.si(0,this.goodcells.length-1)],this.extradone++}let e=[t.x,t.y];for(let o=0;o<10;o++){const o=[t.x+this.r.si(-6,6),t.y+this.r.si(-6,6)];if(!(o[0]<0||o[0]>this.w-0||o[1]<0||o[1]>this.h-0||this.getspa(o[0],o[1])<=0)){e=o;break}}return Math.abs(e[0]-this.hw)<6&&this.r.sb(this.f.r.hd(0,1,"com middleness"))&&(e[0]=Math.floor(this.hw)),m[this.r.schoose(this.f.componentChances)](this,e),this.totaldone++,!1}}const M="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function w(){for(var t,e="",o=0;o<16;o++)e+=M[(t=M.length-1,Math.floor(Math.random()*(t-0+1)+0))];return e}function b(t){return new c(t||w())}function y(t,e,o){const s=new p(t,e||w(),o);return function(t){var e=!1;do{e=t.addcomponent()}while(!e);t.cfx.clearRect(t.hw+t.w%2,0,t.w,t.h),t.cfx.scale(-1,1),t.cfx.drawImage(t.cf,0-t.w,0)}(s),s}}]);const h=s.Randomizer,i=s.generateFaction,r=s.generateShip;function a(t){const e=t.getContext("2d");let o=t.width,s=t.height;const h=e.getImageData(0,0,o,s),i=function(t,e,o){for(let s=0;s<o;s++)for(let o=0;o<e;o++)if(t.data[4*(s*e+o)+3]>0)return s;return-1}(h,o,s),r=function(t,e,o){for(let s=o-1;s>=0;s--)for(let o=0;o<e;o++)if(t.data[4*(s*e+o)+3]>0)return s;return-1}(h,o,s),a=function(t,e,o){for(let s=0;s<e;s++)for(let h=0;h<o;h++)if(t.data[4*(h*e+s)+3]>0)return s;return-1}(h,o,s),n=function(t,e,o){for(let s=e-1;s>=0;s--)for(let h=0;h<o;h++)if(t.data[4*(h*e+s)+3]>0)return s;return-1}(h,o,s);if(i<0)return t.width=0,t.height=0,[0,0];o=1+n-a,s=1+r-i;const c=e.getImageData(a,i,o,s);return t.width=o,t.height=s,e.putImageData(c,0,0),[a,i]}function n(t,e){return Math.sqrt(t*t+e*e)}function c(t){const e=function(t,e,o,s){const h=Math.floor(t/12),i=Math.floor(e/12),r=[],a=Math.floor(e/(2*i));for(let o=0;o<i;o++){const s=o%2==0?h:h-1,n=o%2==0?Math.floor(t/(2*h)):Math.floor(t/h);for(let c=0;c<s;c++)r.push([n+Math.round((c+2*(Math.random()-.5)*.5)*t/h),a+Math.round((o+2*(Math.random()-.5)*.5)*e/i)])}return r}(t.width,t.height),o=t.getContext("2d"),s=t.width,h=t.height,i=o.getImageData(0,0,s,h),r=[];e.forEach(()=>{r.push({minX:-1,minY:-1,maxX:-1,maxY:-1,points:[]})});for(let t=0;t<h;t++)for(let o=0;o<s;o++){const h=4*(t*s+o);if(0===i.data[h+3])continue;let a=n(e[0][0]-o,e[0][1]-t),c=0;for(let s=1;s<e.length;s++){const h=n(e[s][0]-o,e[s][1]-t);h<a&&(a=h,c=s)}const l=r[c];l.minX<0?(l.minX=o,l.minY=t,l.maxX=o,l.maxY=t):(o<l.minX&&(l.minX=o),o>l.maxX&&(l.maxX=o),t<l.minY&&(l.minY=t),t>l.maxY&&(l.maxY=t)),l.points.push([o,t,i.data[h],i.data[h+1],i.data[h+2],i.data[h+3]])}const a=[];for(let t=0;t<r.length;t++){const o=r[t];if(o.minX>-1){const s=o.maxX-o.minX+1,h=o.maxY-o.minY+1,i=document.createElement("canvas");i.width=s,i.height=h;const r=i.getContext("2d"),n=r.getImageData(0,0,i.width,i.height);o.points.forEach(t=>{const e=4*((t[1]-o.minY)*s+(t[0]-o.minX));n.data[e]=t[2],n.data[e+1]=t[3],n.data[e+2]=t[4],n.data[e+3]=t[5]}),r.putImageData(n,0,0),a.push({center:e[t],canvas:i,corner:[o.minX,o.minY]})}}return a}function l(t,e,o){Math.round((e+o)/2);const s=1.5+1.5*Math.random(),h=t.center[0]-e/2,i=t.center[1]-o/2,r=Math.sqrt(h*h+i*i),a=r*r,n=r*s;t.translateX=(n-r)*Math.sqrt((a-i*i)/a)*(h>0?1:-1),t.translateY=(n-r)*Math.sqrt((a-h*h)/a)*(i>0?1:-1),t.angle=(360*Math.random()*2-360)/((Math.random()+2)*t.canvas.width)*10*(Math.PI/180)}function f(t){const e=document.createElement("canvas");e.width=Math.floor(2*R),e.height=Math.floor(2*O);const o=e.getContext("2d"),s=e.width/2-15,h=e.height/2-30;o.setTransform(1.5,0,0,O/R*1.5,0,0);const i=o.createRadialGradient(s,h,10,s,h,30-3*t);return i.addColorStop(0,"transparent"),i.addColorStop(.7,"blue"),i.addColorStop(1,"cyan"),o.fillStyle=i,o.beginPath(),o.arc(s,h,R/2,0,7),o.fill(),a(e),e}function d(t){const e=document.createElement("canvas");e.width=20,e.height=20;const o=e.getContext("2d");var s=o.createRadialGradient(10,10,0,10,10,10);return s.addColorStop(t,"yellow"),s.addColorStop(1,"red"),o.fillStyle=s,o.beginPath(),o.arc(10,10,10,0,7),o.fill(),e}const u=Math.floor(240),g=Math.floor(350);let m,x,p=!1,M=!1,w=-1,b=-1,y=-1,S=-1,v=-1,C=-1,T=-1,P=-1,I=document.getElementById("a");const B=i("piBbgDn4CZqlkqiF"),A=r(B,"ie7jMyCFouoUjkVs",60).cf;a(A);const F=c(A),R=A.width,O=A.height;let q,k,D,X,Y,_=[m-Math.floor(R/2),x-Math.floor(O/2),R,O];const G=function(){const t=[];for(let e=0;e<5;e++)t.push(f(e));return t}(),z=[],j=function(){const t=document.createElement("canvas");t.width=20,t.height=60;const e=t.getContext("2d");return e.fillStyle="yellow",e.beginPath(),e.moveTo(10,60),e.lineTo(20,10),e.arc(10,10,10,0,Math.PI,!0),e.lineTo(10,60),e.fill(),e.strokeStyle="cyan",e.shadowColor="blue",e.globalCompositeOperation="source-atop",e.shadowBlur=4,e.lineWidth=10,e.beginPath(),e.moveTo(10,70),e.lineTo(23,10),e.arc(10,10,13,0,Math.PI,!0),e.lineTo(10,70),e.stroke(),t}(),E=function(){const t=[];for(let e=0;e<9;e++)t.push(d(e/10));for(let e=t.length-2;e>=1;e--)t.push(t[e]);return t}(),H=function(){const t=document.createElement("canvas");t.width=60,t.height=60;const e=t.getContext("2d");var o=e.createRadialGradient(30,30,0,30,30,30);return o.addColorStop(.6,"navy"),o.addColorStop(1,"blue"),e.fillStyle=o,e.beginPath(),e.arc(30,30,30,0,7),e.fill(),t}();let L,N,K,W=performance.now(),U=0;const Q=JSON.parse(localStorage.pnf_highscores||"false")||[];function J(t){const e=t[0];a(e);const o=function(t){const e=document.createElement("canvas"),{width:o,height:s}=t;e.width=o,e.height=s;const h=t.getContext("2d"),i=e.getContext("2d"),r=h.getImageData(0,0,o,s),{data:a}=r,{length:n}=a;for(let t=0;t<n;t+=4){const e=a[t+0],o=a[t+1],s=a[t+2];a[t+0]=255-(.393*e+.769*o+.189*s),a[t+1]=255-(.349*e+.686*o+.168*s),a[t+2]=255-(.272*e+.534*o+.131*s)}return i.putImageData(r,0,0),e}(e),s=c(e);t[1]=o,t[2]=s}const V=[["c4pf4K5xHzu4CyZM","Wl9w64KNQvFNbbbU",50,10,.35,0,[]],["VTjHVRDIYTbXk766","a3QM5c7MnbQlWns3",80,30,.27,0,[]],["1fOXvyryYCvwBWPL","I4xttvPYWxB1So2A",230,80,.2,6,[]],["VsM4qdcBSiuCPDGJ","q4D72OvJMb23kSZC",60,20,.4,0,[]],["l4pyu8yF0mt84Q4u","jPU5GcKNpf2JMgoG",100,40,.35,0,[[g]]],["NMp3mtsPHIwzMKYk","dBzvSKo7wpema3S5",220,90,.22,9,[]],["o67yOby6izpasGgo","fyKKupDEId96qQHu",70,20,.5,0,[[g]]],["IU7xqL8UqZIXJQDQ","aVBO8buAfBbQ4DOY",100,40,.35,0,[[g,6]]],["LP6kUeGMn7S5xZzi","p5O7jAQK67mDULTD",230,100,.25,14,[]],["SsSvCKpjLVTGITYH","aOEjI2Owpqpl06ex",65,30,.5,0,[[g]]],["AGUwhB1E94wgKe49","pwUtokX7oS7ZKFK1",110,50,.35,6,[[g,6]]],["qRF6GA3xnzX0lMcH","RIdNudvB6T2ro7C3",240,120,.3,22,[]]];function Z(t,e){return t[0]<e[0]+e[2]&&t[0]+t[2]>e[0]&&t[1]<e[1]+e[3]&&t[1]+t[3]>e[1]}const $=[["F","orange",t=>{D=t+6500}],["S","cyan",()=>{Y++}],["B","red",t=>{X=t+1e3,ft+=1500}]];class tt{constructor(t,e,o,s){this.x=t,this.y=e,this.type=o,this.lastTime=s,this.frame=0,this.alwaysOnTop=!0}run(t,e,o){this.y+=5*(o-this.lastTime)/32,this.frame=(this.frame+1)%50;const s=[this.x-Math.floor(H.width/2),this.y-Math.floor(H.height/2),H.width,H.height];if(!q&&Z(_,s))return $[this.type][2](o),!1;if(this.y-Math.floor(H.height/2)>700)return!1;this.lastTime=o,e.save(),e.translate(this.x,this.y),e.drawImage(H,-Math.floor(H.width/2),-Math.floor(H.height/2)),e.textAlign="center",e.textBaseline="top";let h=65;h+=this.frame<25?this.frame:50-this.frame,e.font="700 "+Math.floor(h/2)+"px Arial";const i=e.measureText($[this.type][0]),r=i.actualBoundingBoxDescent-i.actualBoundingBoxAscent;return e.fillStyle=$[this.type][1],e.fillText($[this.type][0],0,-Math.floor(r/2)),e.restore(),!0}}class et{constructor(t,e,o){this.x=t,this.y=e,this.lastTime=o,this.power=10}run(t,e,o){this.y-=20*(o-this.lastTime)/32;const s=[this.x-Math.floor(j.width/2),this.y-Math.floor(j.height/2),j.width,j.height];for(let e=0;e<t.length;e++){const h=t[e];if(Z(s,h.hitBox))return h.hit(this.power,o),!1}return!(this.y+Math.floor(j.height/2)<0||(this.lastTime=o,e.drawImage(j,this.x-Math.floor(j.width/2),this.y-Math.floor(j.height/2)),0))}}class ot{constructor(t,e,o,s,h){this.time=h,this.center=t.center,this.canvas=t.canvas,this.corner=t.corner,this.translateX=t.translateX,this.translateY=t.translateY,this.angle=t.angle,this.shipX=e,this.shipY=o,this.duration=s}run(t,e,o){const s=o-this.time;if(s>this.duration)return!1;const h=this.shipX+this.center[0]+this.translateX*Math.min(s,this.duration)/this.duration,i=this.shipY+this.center[1]+this.translateY*Math.min(s,this.duration)/this.duration;return e.save(),e.globalAlpha=1-(Math.min(s,this.duration)/this.duration)**2,e.translate(h,i),e.rotate(this.angle*Math.min(s,this.duration)/this.duration),e.drawImage(this.canvas,this.corner[0]-this.center[0],this.corner[1]-this.center[1]),e.restore(),!0}}class st{constructor(t,e,o,s,h,i){this.width=E[0].width,this.height=E[0].height,this.x=t,this.y=e;const r=Math.sqrt((o-t)**2+(s-e)**2);this.xFactor=(o-t)/r,this.yFactor=(s-e)/r,this.lastTime=i,this.speed=h,this.frame=0,this.alwaysOnTop=!0,this.updateHitBox()}run(t,e,o){if(X>o)return!1;const s=o-this.lastTime;if(this.y+=s*this.speed*this.yFactor,this.x+=s*this.speed*this.xFactor,this.updateHitBox(),Z(_,this.hitBox)){if(Y)return Y--,!1;q=!0}return!(this.y-Math.floor(this.height/2)>700||this.y+Math.floor(this.height/2)<0||this.x-Math.floor(this.width/2)>480||this.x+Math.floor(this.width/2)<0||(this.lastTime=o,this.frame=(this.frame+1)%E.length,e.drawImage(E[this.frame],this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height),0))}updateHitBox(){this.hitBox=[this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height]}}function ht(t,e,o,s,h,i){const r=[];for(let a=0;a<t;a++){const n=s+2*a*Math.PI/t;r.push(new st(e,o,e+Math.round(100*Math.cos(n)),o+Math.round(100*Math.sin(n)),h,i))}return r}class it{constructor(t,e,o,s,h,i,r,a,n,c,l){this.fireAngle=ct.sd(0,2*Math.PI),this.canvas=t,this.hitCanvas=e,this.width=t.width,this.height=t.height,this.health=r,this.x=s,this.y=h,this.lastTime=l,this.hitTime=0,this.destroyedSprites=o,this.speed=i,this.points=a,this.deathBullets=n,this.fireSequences=c,this.updateHitBox()}run(t,e,o){const s=this.y;let h=!1;if(this.health<=0||X>o?h=!0:(this.y+=(o-this.lastTime)*this.speed,this.updateHitBox(),Z(_,this.hitBox)&&(Y?(Y--,h=!0):q=!0)),h)return N+=this.points,K=(new Intl.NumberFormat).format(N),(this.deathBullets>0?ht(this.deathBullets,this.x,this.y+Math.round(17*this.speed),this.fireAngle,.45,o):[]).concat(this.destroyedSprites.map(t=>(l(t,this.width,this.height),new ot(t,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),500,o))));if(this.y-Math.floor(this.height/2)>700)return!1;this.lastTime=o;const i=o-this.hitTime;let r=0;if(i<400&&(r=(400-i)/400),e.save(),e.drawImage(this.canvas,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height),r>0&&(e.globalAlpha=r,e.drawImage(this.hitCanvas,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height)),e.restore(),!q)for(let t=0;t<this.fireSequences.length;t++){const e=this.fireSequences[t][0];if(s<e&&this.y>e){const e=this.fireSequences[t][1],s=this.y+Math.round(17*this.speed);return e?[this,...ht(e,this.x,s,this.fireAngle,.3,o)]:[this,new st(this.x,s,m,x,.3,o)]}}return!0}updateHitBox(){this.hitBox=[this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height]}hit(t,e){this.hitTime=e,this.health-=t}}let rt,at,nt,ct,lt,ft,dt,ut,gt,mt,xt=5,pt=innerWidth/innerHeight;onload=t=>{I.width=480,I.height=700,I.getContext("2d"),onresize(),requestAnimationFrame((function t(e){(function(t){switch(U){case 0:case 1:!function(t){const e=I.getContext("2d");e.fillStyle="#000",e.fillRect(0,0,480,700),e.fillStyle="#fff";let o=(t-W)/3e3;e.save();for(let t=800;t--;){let s=200/(4-(o+t/13)%4);e.globalAlpha=Math.min(s/400,1),e.beginPath(),e.arc(Math.cos(t)*s+u,Math.sin(t*t)*s+g,s/800,0,7),e.fill()}if(e.restore(),e.textBaseline="middle",e.textAlign="center",1===U){if(0===Q.length)e.font="bold 40px monospace",e.fillText("PLANET NOT FOUND",u,g);else{e.font="bold 30px monospace",e.fillText("HIGH SCORES",u,100),e.save(),e.textAlign="start",e.textBaseline="top";for(let t=0;t<Q.length;t++){const o=Intl.NumberFormat().format(Q[t][0]),s=new Date(Q[t][1]).toLocaleString();e.font="60px monospace",e.fillText(String(t+1)+"{",110,150+80*t),e.font="25px monospace",e.fillText(o+" points",180,155+80*t),e.font="15px monospace",e.fillText(s,180,185+80*t)}e.restore()}e.font="20px monospace",e.fillText("Press anywhere to play",u,670),p?M||(U=2,L=0,ct=new h("enemy"),lt=new h("powerup"),ft=1e3,dt=5e3,ut=9e3,gt=0,nt=0,rt=[],at=[],W=performance.now(),mt=performance.now(),N=0,K=(new Intl.NumberFormat).format(N),q=!1,m=u,x=Math.floor(630),D=0,X=0,Y=1):M=!1}else if(e.font="italic 30px monospace",e.fillText("Loading…",u,g),z.length<V.length)z.push(function(t,e,o,...s){return[function(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const o=e.getContext("2d");return o.scale(1,-1),o.drawImage(t,0,0,t.width,-t.height),e}(r(i(t),e,o).cf),void 0,void 0,...s]}(...V[z.length]));else{let t=!0;for(let e=0;t&&e<z.length;e++)z[e][1]||(t=!1,J(z[e]));t&&(U=1)}}(t);break;case 2:!function(t){const e=t-mt;if(mt=t,e>160)return void(W+=e);if(!q){const t=m,o=x;T>-1&&(m+=Math.sign(T-m)*Math.min(Math.abs(T-m),.6*e)),T>-1&&(x+=Math.sign(P-x)*Math.min(Math.abs(P-x),.6*e)),m!==t&&(m-Math.floor(R/2)<0?m=Math.floor(R/2):m+Math.floor(R/2)>480&&(m=480-Math.floor(R/2))),x!==o&&(x-Math.floor(O/2)<0?x=Math.floor(O/2):x+Math.floor(O/2)>700&&(x=700-Math.floor(O/2))),m===t&&x===o||(_=[m-Math.floor(R/2),x-Math.floor(O/2),R,O])}const o=I.getContext("2d");let s;o.fillStyle="black",o.fillRect(0,0,480,700),o.fillStyle="#777";for(let e=100;e--;o.beginPath(),o.arc(Math.floor(-60*(100-e)*(m-R/2)/(100*(480-R)))+Math.floor(270)+Math.floor(270)*Math.sin(540*s),700*(Math.tan(e/9)+s*(t-W)/3e3)%700,2*s,0,7),o.fill())s=149/(3*e+199);const h=q,i=[],r=[],a=[];function n(e){const s=e.run(at,o,t-W);"boolean"==typeof s?s&&(e.alwaysOnTop?r.push(e):i.push(e),e.hit&&a.push(e)):Array.isArray(s)&&s.forEach(t=>{e===t?s&&(e.alwaysOnTop?r.push(e):i.push(e),e.hit&&a.push(e)):n(t)})}if(rt.forEach(n),!h&&q&&(k=t-W,F.map(e=>(l(e,R,O),new ot(e,m-Math.floor(R/2),x-Math.floor(O/2),1500,t-W))).forEach(n)),rt=i.concat(r),at=a,o.fillStyle="#fff",o.textAlign="center",q)o.save(),o.globalAlpha=Math.min(1,(t-W-k)/2e3),o.textBaseline="middle",o.font="40px monospace",o.fillText("Game Over",u,g),o.restore();else{if(Y){const t=G[Math.min(Y-1,G.length-1)];o.drawImage(t,m-Math.floor(t.width/2),x-Math.floor(t.height/2)+5)}o.drawImage(A,m-Math.floor(R/2),x-Math.floor(O/2))}X>t-W&&(o.save(),o.globalAlpha=(X-t+W)/1e3,o.fillStyle="#fff",o.fillRect(0,0,480,700),o.restore()),o.textBaseline="top",o.font="16px monospace",o.fillText(K,u,5);const c=D>t-W;if(!q&&nt+(c?100:200)<t-W&&(xt=-xt,rt.push(new et(m+(c?xt:0),x-Math.floor(O/2),t-W)),nt=Math.max(t-W)),dt<t-W&&(L++,dt=t-W+1e4),ut<t-W&&(rt.push(new tt(lt.si(30,450),Math.floor(-H.height/2),gt,t-W)),gt=(gt+1)%$.length,ut=t-W+9e3),ft<t-W){const e=ct.si(Math.min(Math.max(L-2,0),z.length-3),Math.min(L,z.length-1)),[o,s,h,i,r,a,n]=z[e];rt.push(new it(o,s,h,ct.si(30,450),Math.floor(-o.height/2),r,i,50*(e+1),a,n,t-W));const c=Math.max(400,1e3-25*L);ft+=ct.si(c,c+400)}q&&k+3500<t-W&&(N&&(Q.push([N,Date.now()]),Q.sort((t,e)=>{const o=e[0]-t[0];return 0===o?e[1]-t[1]:o}),Q.length=Math.min(Q.length,5),localStorage.pnf_highscores=JSON.stringify(Q)),U=1,M=p)}(t)}})(e),requestAnimationFrame(t)}))};let Mt=0,wt=0,bt=0,yt=0;self.onresize=self.onrotate=t=>{pt=innerWidth/innerHeight,480/700>pt?(bt=innerWidth,yt=innerWidth/(480/700),Mt=0,wt=(innerHeight-yt)/2):(bt=innerHeight*(480/700),yt=innerHeight,Mt=(innerWidth-bt)/2,wt=0),I.style.width=bt+"px",I.style.height=yt+"px"};let St=t=>{let e={};return e=t.changedTouches?t.changedTouches[0]:t,[~~(480*(e.pageX-Mt)/bt),~~(700*(e.pageY-wt)/yt)]};onclick=t=>{t.preventDefault(),[w,b]=St(t)},self.onmousedown=self.ontouchstart=t=>{t.preventDefault(),p=!0,[y,S]=St(t),T=y,P=S},self.onmousemove=self.ontouchmove=t=>{t.preventDefault(),[T,P]=St(t)},self.onmouseup=self.ontouchend=t=>{t.preventDefault(),p=!1,[v,C]=St(t),t.changedTouches&&onclick()},oncontextmenu=t=>{t.preventDefault()}}]);</script></body></html>