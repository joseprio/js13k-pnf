!function(){"use strict";class t{constructor(t){this.seedPosition=0,this.arrayPosition=0,this.hrCache={},this.seed=t,this.seed.length<8&&(this.seed="padding_"+this.seed),this.seed.length%2==0&&(this.seed="1"+this.seed),this.stateArray=[2972948403,3086140710,2071788248,3026137486,1411764137,2265725585,2923087685,1593177610],this.state=3234042090;for(var e=this.seed.length-1;e>=0;e--){var h=this.seed.charCodeAt(e);this.state=((this.state<<5)+this.state^h^this.state<<h%13+1^this.state>>h%17+1)>>>0,this.stateArray[e%8]^=((this.state>>9)*(this.state%16384+3427)^h)>>>0}}sr(){var t=this.seed.charCodeAt(this.seedPosition),e=this.stateArray[this.arrayPosition];return this.state=((this.state<<5)+this.state+e^t^this.state<<t%17+1^this.state>>t%13+1)>>>0,this.stateArray[this.arrayPosition]=(e>>3^e<<t%19+1^this.state%134217728*3427)>>>0,this.seedPosition=(this.seedPosition+1)%this.seed.length,this.arrayPosition=(this.arrayPosition+1)%8,this.state}hr(t){const e=[1160605769,1424711319,876532818,1419174464];let h=1206170165;if(null==t&&(t="?/?/?/",h=3379896793),this.hrCache.hasOwnProperty(t))return this.hrCache[t];for(var s=t.length-1;s>=0;s--){const i=t.charCodeAt(s);let o=e[0]^i;o=(o^o<<11)>>>0,o=(o^o>>8)>>>0,e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=(e[3]^e[3]>>19^o)>>>0,h=3427*(h^i<<24)^e[3]}for(var i=this.seed.length-1;i>=0;i--){const t=this.seed.charCodeAt(i);let s=e[0]^t;s=(s^s<<11)>>>0,s=(s^s>>8)>>>0,e[0]=e[1],e[1]=e[2],e[2]=e[3],e[3]=(e[3]^e[3]>>19^s)>>>0,h=3427*(h^t<<24)^e[3]}return this.hrCache[t]=h>>>0,this.hrCache[t]}sd(t,e){return(4294967296*this.sr()+this.sr())/0x10000000000000000*(e-t)+t}hd(t,e,h){return(4294967296*this.hr(h)+this.hr(h+"@"))/0x10000000000000000*(e-t)+t}si(t,e){return Math.floor((4294967296*this.sr()+this.sr())/0x10000000000000000*(e+1-t)+t)}hi(t,e,h){return Math.floor((4294967296*this.hr(h)+this.hr(h+"@"))/0x10000000000000000*(e+1-t)+t)}sb(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t}hb(t,e){return(4294967296*this.hr(e)+this.hr(e+"@"))/0x10000000000000000<t}ss(t){return(4294967296*this.sr()+this.sr())/0x10000000000000000<t?-1:1}sseq(t,e){for(var h=0;(4294967296*this.sr()+this.sr())/0x10000000000000000<t&&h<e;)h++;return h}hseq(t,e,h){for(var s=0;(4294967296*this.hr(h+s)+this.hr(h+"@"+s))/0x10000000000000000<t&&s<e;)s++;return s}schoose(t){let e=0;for(let h=0;h<t.length;h++)e+=t[h];let h=this.sd(0,e);for(let e=0;e<t.length;e++)if(h-=t[e],h<0)return e;return 0}hchoose(t,e){let h=0;for(let e=0;e<t.length;e++)h+=t[e];let s=this.hd(0,h,e);for(let e=0;e<t.length;e++)if(s-=t[e],s<0)return e;return 0}}function e(t,e,h){return Math.max(e,Math.min(h,t))}function h(t,e){for(var h=Math.floor(t).toString(16);h.length<e;)h="0"+h;return h}function s(t){return"#"+h(Math.floor(255*e(t[0],0,1)),2)+(h(Math.floor(255*e(t[1],0,1)),2)+h(Math.floor(255*e(t[2],0,1)),2))}function i(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function o(t){var e=t[1]*t[2],h=t[2]-e,s=(t[0]%1+1)%1*6,i=Math.floor(s),o=e*(1-Math.abs(s%2-1));switch(i){case 0:return[e+h,o+h,h];case 1:return[o+h,e+h,h];case 2:return[h,e+h,o+h];case 3:return[h,o+h,e+h];case 4:return[o+h,h,e+h];default:return[e+h,h,o+h]}}class a{constructor(e){this.componentChances=[],this.colors=[],this.colorChances=[],this.seed=e,this.r=new t(this.seed),this.setupComponentChances(),this.setupColors()}setupComponentChances(){this.componentChances=[],this.componentChances[0]=.8*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[1]=.9*this.r.sd(.01,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[2]=1*this.r.sd(.001,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[3]=3*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[4]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[5]=.05*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8)),this.componentChances[6]=.5*this.r.sd(0,1)*Math.pow(2,this.r.sd(0,8))}setupColors(){const t=1+(this.r.hb(.7,"base color +1")?1:0)+this.r.hseq(.3,3,"base color count");for(let h=0;h<t;h++){const t="base color"+h;this.colors.push(o([Math.pow(this.r.hd(0,1,t+"hue"),2),e(this.r.hd(-.2,1,t+"saturation"),0,Math.pow(this.r.hd(0,1,t+"saturation bound"),4)),e(this.r.hd(.7,1.1,t+"value"),0,1)])),this.colorChances.push(Math.pow(2,this.r.hd(0,6,t+"chances")))}}getBaseColor(t){let h=this.colors[t.r.schoose(this.colorChances)];return t.r.sb(Math.pow(this.r.hd(0,.5,"base color shift chance"),2))&&(h=[h[0],h[1],h[2]],h[0]=e(h[0]+Math.pow(this.r.hd(0,.6,"base color shift range red"),2)*e(t.r.sd(-1,1.2),0,1)*e(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),h[1]=e(h[1]+Math.pow(this.r.hd(0,.6,"base color shift range green"),2)*e(t.r.sd(-1,1.2),0,1)*e(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1),h[2]=e(h[2]+Math.pow(this.r.hd(0,.6,"base color shift range blue"),2)*e(t.r.sd(-1,1.2),0,1)*e(t.r.ss(.7)+t.r.ss(.7),-1,1),0,1)),h}}function r(t,e){return 1-e[1]/t.h}function n(t,e,h,s){let i=1;return h&&(i=Math.min(i,1-Math.abs(e[0]-t.hw)/t.hw)),s&&(i=Math.min(i,1-Math.abs(e[1]-t.hh)/t.hh)),i}function l(t,e){return n(t,e,!0,!0)*(1-1/((t.w+t.h)/1e3+1))*Math.pow(t.f.r.hd(0,1,"master bigness"),.5)*(1-t.getpcdone())}function c(t,e){return[Math.min(e[0][0]-0,t.w-0-e[1][0]),Math.min(e[0][1]-0,t.h-0-e[1][1])]}function f(t,h,s,i){const o=t.createLinearGradient(s[0],s[1],2*h[0]-s[0],2*h[1]-s[1]),a=`rgba(0,0,0,${e(i,0,1)})`;return o.addColorStop(0,a),o.addColorStop(.5,"rgba(0,0,0,0)"),o.addColorStop(1,a),o}const d=[];d[0]=function(t,h){let o=8;const a=Math.pow(l(t,h),.3);if(t.r.sb(t.f.r.hd(0,.9,"com0 bigchance")*a)){const e=t.f.r.hd(0,.5,"com0 bigincchance");for(;t.r.sb(e*a);){const e=c(t,[[h[0]-o,h[1]-o],[h[0]+o,h[1]+o]]);if(!(Math.min(e[0],e[1])>.5*o))break;o*=1.5}}const r=2*o,n=[Math.ceil(t.r.sd(1,Math.max(2,.5*o))),Math.ceil(t.r.sd(1,Math.max(2,.5*o)))],d=Math.min(n[0],n[1])*t.r.sd(.1,1.2),g=[n[0]+2*d,n[1]+2*d],u=[Math.ceil(r/g[0]),Math.ceil(r/g[1])],x=[Math.round(u[0]*g[0]/2),Math.round(u[1]*g[1]/2)],M=t.getpcdone(),m=t.f.getBaseColor(t),p=s(i(m,t.r.sd(.4,1))),w=s(i(m,t.r.sd(.4,1)));t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(h[0]-x[0]-1,h[1]-x[1]-1,g[0]*u[0]+2,g[1]*u[1]+2),t.cfx.fillStyle=w,t.cfx.fillRect(h[0]-x[0],h[1]-x[1],g[0]*u[0],g[1]*u[1]),t.cfx.fillStyle=p;for(let e=0;e<u[0];e++){const s=h[0]+d+e*g[0]-x[0];for(let e=0;e<u[1];e++)t.cfx.fillRect(s,h[1]+d+e*g[1]-x[1],n[0],n[1])}t.r.sb(e(o/8*(.6*M+.3),0,.98))&&(t.cfx.fillStyle=f(t.cfx,h,[h[0]+x[0],h[1]],t.r.sd(0,.9)),t.cfx.fillRect(h[0]-x[0],h[1]-x[1],g[0]*u[0],g[1]*u[1]))},d[1]=function(t,h){let o=8;const a=Math.pow(l(t,h),.2);if(t.r.sb(t.f.r.hd(.3,1,"com1 bigchance")*a)){const e=t.f.r.hd(0,.6,"com1 bigincchance");for(;t.r.sb(e*a);){const e=c(t,[[h[0]-o,h[1]-o],[h[0]+o,h[1]+o]]);if(!(Math.min(e[0],e[1])>.5*o))break;o*=1.5}}let r=Math.ceil(t.r.sd(.8,2)*o);const n=Math.ceil(t.r.sd(.8,2)*o),d=t.r.si(3,Math.max(4,r)),g=Math.max(1,Math.round(r/d));r=g*d;const u=s(i(t.f.getBaseColor(t),t.r.sd(.5,1))),x=t.r.sd(.3,.9);if(t.r.sb(e(t.f.r.hd(-.2,1.2,"com1 hchance"),0,1))){const e=[h[0]-Math.floor(r/2),h[1]-Math.floor(n/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(e[0]-1,e[1]-1,r+2,n+2),t.cfx.fillStyle=u,t.cfx.fillRect(e[0],e[1],r,n);for(let s=0;s<g;s++)t.cfx.fillStyle=f(t.cfx,[e[0]+(s+.5)*d,h[1]],[e[0]+s*d,h[1]],x),t.cfx.fillRect(e[0]+s*d,e[1],d,n)}else{const e=[h[0]-Math.floor(n/2),h[1]-Math.floor(r/2)];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.25)+")",t.cfx.fillRect(e[0]-1,e[1]-1,n+2,r+2),t.cfx.fillStyle=u,t.cfx.fillRect(e[0],e[1],n,r);for(let s=0;s<g;s++)t.cfx.fillStyle=f(t.cfx,[h[0],e[1]+(s+.5)*d],[h[0],e[1]+s*d],x),t.cfx.fillRect(e[0],e[1]+s*d,r,d)}},d[2]=function(t,h){let o=8;const a=Math.pow(l(t,h),.05);if(t.r.sb(t.f.r.hd(0,1,"com2 bigchance")*a)){const e=t.f.r.hd(0,.9,"com2 bigincchance");for(;t.r.sb(e*a);){const e=c(t,[[h[0]-o,h[1]-o],[h[0]+o,h[1]+o]]);if(!(Math.min(e[0],e[1])>.5*o))break;o*=1.5}}const r=Math.ceil(t.r.sd(.6,1.4)*o),n=Math.ceil(t.r.sd(1,2)*o),f=[Math.ceil(e(r*t.r.sd(.7,1)/2,1,r)),Math.ceil(e(r*t.r.sd(.8,1)/2,1,r))],d=[Math.floor(e(r*t.r.sd(.05,.25),1,n)),Math.floor(e(r*t.r.sd(.1,.3),1,n))],g=d[0]+d[1],u=t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 oddchance"),.5)),x=e(Math.floor(n/g),1,n),M=x*g+(u?d[0]:0),m=t.f.getBaseColor(t),p=[i(m,t.r.sd(.6,1)),i(m,t.r.sd(.6,1))],w=1-t.r.sd(.5,.95),y=[i(p[0],w),i(p[1],w)];if(t.r.sb(Math.pow(t.f.r.hd(0,1,"com2 verticalchance"),.1))){const e=[t.cfx.createLinearGradient(h[0]-f[0],h[1],h[0]+f[0],h[1]),t.cfx.createLinearGradient(h[0]-f[1],h[1],h[0]+f[1],h[1])];e[0].addColorStop(0,s(y[0])),e[0].addColorStop(.5,s(p[0])),e[0].addColorStop(1,s(y[0])),e[1].addColorStop(0,s(y[1])),e[1].addColorStop(.5,s(p[1])),e[1].addColorStop(1,s(y[1]));const i=Math.floor(h[1]-M/2);for(let s=0;s<x;s++)t.cfx.fillStyle=e[0],t.cfx.fillRect(h[0]-f[0],i+s*g,2*f[0],d[0]),t.cfx.fillStyle=e[1],t.cfx.fillRect(h[0]-f[1],i+s*g+d[0],2*f[1],d[1]);u&&(t.cfx.fillStyle=e[0],t.cfx.fillRect(h[0]-f[0],i+x*g,2*f[0],d[0]))}else{const e=[t.cfx.createLinearGradient(h[0],h[1]-f[0],h[0],h[1]+f[0]),t.cfx.createLinearGradient(h[0],h[1]-f[1],h[0],h[1]+f[1])];e[0].addColorStop(0,s(y[0])),e[0].addColorStop(.5,s(p[0])),e[0].addColorStop(1,s(y[0])),e[1].addColorStop(0,s(y[1])),e[1].addColorStop(.5,s(p[1])),e[1].addColorStop(1,s(y[1]));const i=Math.floor(h[0]-M/2);for(let s=0;s<x;s++)t.cfx.fillStyle=e[0],t.cfx.fillRect(i+s*g,h[1]-f[0],d[0],2*f[0]),t.cfx.fillStyle=e[1],t.cfx.fillRect(i+s*g+d[0],h[1]-f[1],d[1],2*f[1]);u&&(t.cfx.fillStyle=e[0],t.cfx.fillRect(i+x*g,h[1]-f[0],d[0],2*f[0]))}},d[3]=function(t,e){if(t.r.sb(r(t,e)-.3)||t.getcellstate(e[0],e[1]+6*1.2)>0||t.getcellstate(e[0],e[1]+10.8)>0)for(let h=0;h<100;h++){const h=t.r.schoose(t.f.componentChances);if(3!=h)return void d[h](t,e)}let h=8;const o=Math.pow(l(t,e),.1);if(t.r.sb(t.f.r.hd(.6,1,"com3 bigchance")*o)){const s=t.f.r.hd(.3,.8,"com3 bigincchance");for(;t.r.sb(s*o);){const s=c(t,[[e[0]-h,e[1]-h],[e[0]+h,e[1]+h]]);if(!(Math.min(s[0],s[1])>.5*h))break;h*=1.5}}const a=t.r.sd(1,2)*h;let n=Math.ceil(t.r.sd(.3,1)*h);const f=a*t.r.sd(.25,.6),g=(a+f)/2/2,u=[Math.max(1,Math.ceil(n*t.r.sd(.08,.25))),Math.max(1,Math.ceil(n*t.r.sd(.03,.15)))],x=u[0]+u[1],M=Math.ceil(n/x);n=M*x+u[0],t.f.setupColors();const m=t.f.colors[t.f.r.hchoose(t.f.colorChances,"com3 basecolor")],p=t.f.r.hd(.5,.8,"com3 lightness0 mid"),w=p-t.f.r.hd(.2,.4,"com3 lightness0 edge"),y=t.f.r.hd(0,.2,"com3 lightness1 edge"),b=[t.cfx.createLinearGradient(e[0]-g,e[1],e[0]+g,e[1]),t.cfx.createLinearGradient(e[0]-g,e[1],e[0]+g,e[1])];b[0].addColorStop(0,s(i(m,w))),b[0].addColorStop(.5,s(i(m,p))),b[0].addColorStop(1,s(i(m,w))),b[1].addColorStop(0,s(i(m,y))),b[1].addColorStop(.5,s(m)),b[1].addColorStop(1,s(i(m,y)));const C=Math.ceil(e[1]-n/2);t.cfx.fillStyle=b[0],t.cfx.beginPath(),t.cfx.moveTo(e[0]-f/2,C),t.cfx.lineTo(e[0]+f/2,C),t.cfx.lineTo(e[0]+a/2,C+n),t.cfx.lineTo(e[0]-a/2,C+n),t.cfx.fill(),t.cfx.fillStyle=b[1];const S=[C+u[0],C+x];for(let h=0;h<M;h++){const s=[h*x+u[0],(h+1)*x],i=[S[0]+h*x,S[1]+h*x],o=[(f+s[0]/n*(a-f))/2,(f+s[1]/n*(a-f))/2];t.cfx.beginPath(),t.cfx.moveTo(e[0]-o[0],i[0]),t.cfx.lineTo(e[0]+o[0],i[0]),t.cfx.lineTo(e[0]+o[1],i[1]),t.cfx.lineTo(e[0]-o[1],i[1]),t.cfx.fill()}},d[4]=function(t,e){const h=n(t,e,!0,!1),o=t.r.sd(.7,1),a=t.r.sd(0,.2),r=t.f.getBaseColor(t),l=s(i(r,o)),c=s(i(r,a)),f=Math.max(3,Math.ceil(t.size*Math.pow(t.r.sd(.4,1),2)*t.f.r.hd(.02,.1,"com4 maxwidth"))),g=Math.floor(f/2),u=f%2,x=1*Math.pow(t.f.r.hd(0,1,"com4 directionc0"),4),M=.1*Math.pow(t.f.r.hd(0,1,"com4 directionc1"),4),m=.2*Math.pow(t.f.r.hd(0,1,"com4 directionc2"),4),p=t.r.schoose([x*(2-h),M,m*(1+h)]);let w=null;if(0==p){const h=Math.min(Math.max(8,e[1]-0-t.r.si(0,16)),Math.floor(.7*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,6,"com4 hpower0")))),s=[[e[0]-g,e[1]-h],[e[0]+g+u,e[1]]],i=t.cfx.createLinearGradient(s[0][0],s[0][1],s[1][0],s[0][1]);i.addColorStop(0,c),i.addColorStop(.5,l),i.addColorStop(1,c),t.cfx.fillStyle=i,t.cfx.fillRect(s[0][0],s[0][1],f,h),w=[e[0],e[1]-h]}else if(1==p){const h=Math.min(Math.max(8,t.h-(0+e[1])-t.r.si(0,16)),Math.floor(.6*t.size*Math.pow(t.r.sd(0,1),t.f.r.hd(2,7,"com4 hpower1")))),s=[[e[0]-g,e[1]],[e[0]+g+u,e[1]+h]],i=t.cfx.createLinearGradient(s[0][0],s[0][1],s[1][0],s[0][1]);i.addColorStop(0,c),i.addColorStop(.5,l),i.addColorStop(1,c),t.cfx.fillStyle=i,t.cfx.fillRect(s[0][0],s[0][1],f,h),w=[e[0],e[1]+h]}else if(2==p){const h=t.cfx.createLinearGradient(e[0],e[1]-g,e[0],e[1]+g+u);h.addColorStop(0,c),h.addColorStop(.5,l),h.addColorStop(1,c),t.cfx.fillStyle=h,t.cfx.fillRect(e[0],e[1]-g,Math.ceil(t.hw-e[0])+1,f),w=[Math.floor(t.hw),e[1]]}const y=[.6*Math.pow(t.f.r.hd(0,1,"com4 covercomc0"),2),.2*Math.pow(t.f.r.hd(0,1,"com4 covercomc1"),2),1*Math.pow(t.f.r.hd(0,1,"com4 covercomc2"),2)];if(d[t.r.schoose(y)](t,e),t.getcellstate(w[0],w[1])>0){const e=[w[0]+Math.round(6*t.r.sd(-1,1)),w[1]+Math.round(6*t.r.sd(-1,1))];t.getcellstate(e[0],e[1])>0?d[t.r.schoose(y)](t,e):d[t.r.schoose(y)](t,w)}},d[5]=function(t,e){let h=8;const o=Math.pow(l(t,e),.1);if(t.r.sb(t.f.r.hd(0,.9,"com5 bigchance")*o)){const s=t.f.r.hd(0,.8,"com5 bigincchance");for(;t.r.sb(s*o);){const s=c(t,[[e[0]-h,e[1]-h],[e[0]+h,e[1]+h]]);if(!(Math.min(s[0],s[1])>.5*h))break;h*=1.5}}const a=t.r.sd(.75,1),r=t.r.sd(0,.25),n=t.f.getBaseColor(t),f=s(i(n,a)),d=s(i(n,r)),g=1+t.r.sseq(t.f.r.hd(0,1,"com5 multxc"),Math.floor(1.2*Math.pow(h/8,.6))),u=1+t.r.sseq(t.f.r.hd(0,1,"com5 multyc"),Math.floor(1.2*Math.pow(h/8,.6))),x=t.r.sd(.5,1)*h/Math.max(g,u),M=x+.5,m=x+1,p=.2*x,w=[e[0]-x*g,e[1]-x*u];t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")";for(let e=0;e<g;e++){const h=w[0]+(2*e+1)*x;for(let e=0;e<u;e++){const s=w[1]+(2*e+1)*x;t.cfx.beginPath(),t.cfx.arc(h,s,m,0,2*Math.PI),t.cfx.fill()}}for(let e=0;e<g;e++){const h=w[0]+(2*e+1)*x;for(let e=0;e<u;e++){const s=w[1]+(2*e+1)*x,i=t.cfx.createRadialGradient(h,s,p,h,s,M);i.addColorStop(0,f),i.addColorStop(1,d),t.cfx.fillStyle=i,t.cfx.beginPath(),t.cfx.arc(h,s,M,0,2*Math.PI),t.cfx.fill()}}},d[6]=function(t,e){if(t.nextpass<=0||t.r.sb(r(t,e)))return void d[t.r.schoose(function(t,e,h){const s=[,,,,,];for(let e=5;e>=0;e--)s[e-0]=t[e];return s}(t.f.componentChances))](t,e);let h=8;const o=Math.pow(l(t,e),.05);if(t.r.sb(t.f.r.hd(0,.9,"com6 bigchance")*o)){const s=t.f.r.hd(0,.8,"com6 bigincchance");for(;t.r.sb(s*o);){const s=c(t,[[e[0]-h,e[1]-h],[e[0]+h,e[1]+h]]);if(!(Math.min(s[0],s[1])>.5*h))break;h*=1.5}}const a=Math.ceil(2*h*t.r.sd(.6,1)),n=Math.floor(a/2),f=a%2,g=a*Math.pow(t.r.sd(Math.pow(t.f.r.hd(0,.8,"com6 h1min"),.5),.9),t.f.r.hd(.5,1.5,"com6 h1power")),u=Math.floor(g/2),x=a%2,M=Math.max(0-(a-g)/2,a*(t.r.sd(0,.45)+t.r.sd(0,.45))*(t.f.r.hb(.8,"com6 backnesstype")?t.f.r.hd(.2,.9,"com6 backness#pos"):t.f.r.hd(-.2,-.05,"com6 backness#neg"))),m=Math.ceil(h*t.r.sd(.7,1)*Math.pow(t.f.r.hd(.1,3.5,"com6 width"),.5)),p=Math.floor(m/2),w=m%2,y=[[e[0]-p,e[1]+M-u],[e[0]+p+w,e[1]-n],[e[0]+p+w,e[1]+n+f],[e[0]-p,e[1]+M+u+x]],b=t.f.getBaseColor(t);t.cfx.fillStyle="rgba(0,0,0,"+t.r.sd(0,.2)+")",t.cfx.beginPath(),t.cfx.moveTo(y[0][0]-1,y[0][1]),t.cfx.lineTo(y[1][0]-1,y[1][1]),t.cfx.lineTo(y[2][0]-1,y[2][1]),t.cfx.lineTo(y[3][0]-1,y[3][1]),t.cfx.fill(),t.cfx.fillStyle=s(i(b,t.r.sd(.7,1))),t.cfx.beginPath(),t.cfx.moveTo(y[0][0],y[0][1]),t.cfx.lineTo(y[1][0],y[1][1]),t.cfx.lineTo(y[2][0],y[2][1]),t.cfx.lineTo(y[3][0],y[3][1]),t.cfx.fill()};const g=[];g[0]=function(t){const h=(t.w-0)*(t.h-0)*.05,s=Math.ceil((t.w-0)*t.f.r.hd(.1,1,"outline0 iw")*.2),i=[[[t.hw-s,0],[t.hw+s,t.h-0]]],o=2+Math.floor(t.r.sd(.5,1)*t.f.r.hd(2,8,"outline0 bc")*Math.sqrt(t.size));for(let s=1;s<o;s++){const s=i[t.r.si(0,i.length-1)],o=[s[0][0]+t.r.sd(0,1)*(s[1][0]-s[0][0]),s[0][1]+t.r.sd(0,1)*(s[1][1]-s[0][1])];o[1]<.5*(s[0][1]+s[1][1])&&t.r.sb(t.f.r.hd(.5,1.5,"outline0 frontbias"))&&(o[1]=s[1][1]-(o[1]-s[0][1]));const a=[e(t.r.sd(0,1)*t.w,0,t.w-0),e(t.r.sd(0,1)*t.h,0,t.h-0)],r=h/Math.abs((a[0]-o[0])*(a[1]-o[1]));if(r<1&&(a[0]=o[0]+(a[0]-o[0])*r,a[1]=o[1]+(a[1]-o[1])*r),o[0]>a[0]){const t=o[0];o[0]=a[0],a[0]=t}if(o[1]>a[1]){const t=o[1];o[1]=a[1],a[1]=t}i.push([[Math.floor(o[0]),Math.floor(o[1])],[Math.ceil(a[0]),Math.ceil(a[1])]])}t.csx.fillStyle="#FFFFFF";for(let e=0;e<i.length;e++){const h=i[e];t.csx.fillRect(h[0][0],h[0][1],h[1][0]-h[0][0],h[1][1]-h[0][1]),t.csx.fillRect(t.w-h[1][0],h[0][1],h[1][0]-h[0][0],h[1][1]-h[0][1])}},g[1]=function(t){const e=Math.max(2,Math.sqrt((t.w-0)*(t.h-0)*.05/Math.PI)),h=Math.ceil((t.w-0)*t.f.r.hd(.1,1,"outline1 iw")*.2),s=[],i=Math.floor((t.h-0)/(2*h));for(let e=0;e<i;e++)s.push({v:[t.hw,t.h-(0+h*(2*e+1))],r:h});const o=i+Math.floor(t.r.sd(.5,1)*t.f.r.hd(10,50,"outline1 cc")*Math.sqrt(t.size));for(let h=i;h<o;h++){const h=s[Math.max(t.r.si(0,s.length-1),t.r.si(0,s.length-1))];let i=t.r.sd(1,e);const o=t.r.sd(Math.max(0,h.r-i),h.r);let a=t.r.sd(0,2*Math.PI);a>Math.PI&&t.r.sb(t.f.r.hd(.5,1.5,"outline1 frontbias"))&&(a=t.r.sd(0,Math.PI));let r=[h.v[0]+Math.cos(a)*o,h.v[1]+Math.sin(a)*o];i=Math.min(i,r[0]-0),i=Math.min(i,t.w-0-r[0]),i=Math.min(i,r[1]-0),i=Math.min(i,t.h-0-r[1]),s.push({v:r,r:i})}t.csx.fillStyle="#fff";for(let e=0;e<s.length;e++){const h=s[e];t.csx.beginPath(),t.csx.arc(h.v[0],h.v[1],h.r,0,2*Math.PI),t.csx.fill(),t.csx.beginPath(),t.csx.arc(t.w-h.v[0],h.v[1],h.r,0,2*Math.PI),t.csx.fill()}},g[2]=function(t){const e=[t.w-0,t.h-0],h=[[t.hw,t.r.sd(0,.05)*e[1]+0],[t.hw,t.r.sd(.95,1)*e[1]+0]],s=6/t.size+t.f.r.hd(.03,.1,"outline2 basefatness"),i=Math.max(3,Math.ceil(1/s*t.r.sd(.05,.1)*Math.sqrt(t.size)));t.csx.lineCap=["round","square"][t.f.r.hi(0,1,"outline2 linecap")],t.csx.strokeStyle="#fff";for(let o=1;o<i;o++){let i=h[o];null==i&&(i=[t.r.sd(0,1)*e[0]+0,Math.pow(t.r.sd(0,1),t.f.r.hd(.1,1,"outline2 frontbias"))*e[1]+0],h.push(i));const a=1+t.r.sseq(t.f.r.hd(0,1,"outline2 conadjust"),3);for(let e=0;e<a;e++){const e=h[t.r.si(0,h.length-2)];t.csx.lineWidth=t.r.sd(.7,1)*s*t.size,t.csx.beginPath(),t.csx.moveTo(e[0],e[1]),t.csx.lineTo(i[0],i[1]),t.csx.stroke(),t.csx.beginPath(),t.csx.moveTo(t.w-e[0],e[1]),t.csx.lineTo(t.w-i[0],i[1]),t.csx.stroke()}}};class u{constructor(e,h,s){this.extradone=0,this.nextpass=0,this.nextcell=0,this.totaldone=0,this.f=e,this.baseSeed=h,this.seed=this.f.seed+this.baseSeed,this.r=new t(this.seed),this.size=null==s?this.r.sd(this.f.r.hd(2.5,3.5,"size min"),this.f.r.hd(5,7,"size max"))**3:s;const i=this.r.sd(this.f.r.hd(.5,1,"wratio min"),this.f.r.hd(1,1.3,"wratio max")),o=this.r.sd(this.f.r.hd(.7,1,"hratio min"),this.f.r.hd(1.1,1.7,"hratio max"));this.w=Math.floor(this.size*i)+0,this.hw=Math.floor(this.w/2),this.gw=Math.floor((this.w-0)/6),this.gwextra=.5*(this.w-6*this.gw),this.h=Math.floor(this.size*o)+0,this.hh=Math.floor(this.h/2),this.gh=Math.floor((this.h-0)/6),this.ghextra=.5*(this.h-6*this.gh),this.cs=document.createElement("canvas"),this.cs.setAttribute("width",this.w+""),this.cs.setAttribute("height",this.h+""),this.csx=this.cs.getContext("2d"),this.cf=document.createElement("canvas"),this.cf.setAttribute("width",this.w+""),this.cf.setAttribute("height",this.h+""),this.cfx=this.cf.getContext("2d"),g[this.f.r.hchoose([1,1,1],"outline type")](this),this.csd=this.csx.getImageData(0,0,this.w,this.h),this.cgrid=[];for(let t=0;t<this.gw;t++){this.cgrid[t]=[];for(let e=0;e<this.gh;e++)this.cgrid[t][e]={gx:t,gy:e,x:Math.floor(this.gwextra+6*(t+.5)),y:Math.floor(this.ghextra+6*(e+.5)),state:0}}this.goodcells=[this.cgrid[Math.floor(this.gw/2)][Math.floor(this.gh/2)]];let a=0;for(;a<this.goodcells.length;){const t=this.goodcells[a];if(t.gx>0){const e=this.cgrid[t.gx-1][t.gy];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}if(t.gx<this.gw-1){const e=this.cgrid[t.gx+1][t.gy];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}if(t.gy>0){const e=this.cgrid[t.gx][t.gy-1];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}if(t.gy<this.gh-1){const e=this.cgrid[t.gx][t.gy+1];0==e.state&&(this.getspa(e.x,e.y)>0?(e.state=1,this.goodcells.push(e)):e.state=-1)}a++}for(let t=0;t<this.goodcells.length;t++){const e=this.goodcells[t],h=this.cgrid[this.gw-1-e.gx][e.gy];1!=h.state&&(h.state=1,this.goodcells.push(h))}this.passes=this.f.r.hi(1,2,"base component passes"),this.extra=Math.max(1,Math.floor(this.goodcells.length*this.f.r.hd(0,1/this.passes,"extra component amount"))),this.totalcomponents=this.passes*this.goodcells.length+this.extra}getcell(t,e){const h=Math.floor((t-this.gwextra)/6),s=Math.floor((e-this.ghextra)/6);return h<0||h>=this.gw||s<0||s>=this.gh?null:this.cgrid[h][s]}getcellstate(t,e){const h=this.getcell(t,e);return null==h?0:h.state}getspa(t,e){return t=Math.floor(t),e=Math.floor(e),t<0||t>this.w||e<0||e>this.h?-1:this.csd.data[4*(e*this.w+t)+3]}getpcdone(){return this.totaldone/this.totalcomponents}addcomponent(){let t;if(this.nextpass<this.passes)this.nextcell<this.goodcells.length?(t=this.goodcells[this.nextcell],this.nextcell++):(this.nextpass++,t=this.goodcells[0],this.nextcell=1);else{if(!(this.extradone<this.extra))return!0;t=this.goodcells[this.r.si(0,this.goodcells.length-1)],this.extradone++}let e=[t.x,t.y];for(let h=0;h<10;h++){const h=[t.x+this.r.si(-6,6),t.y+this.r.si(-6,6)];if(!(h[0]<0||h[0]>this.w-0||h[1]<0||h[1]>this.h-0||this.getspa(h[0],h[1])<=0)){e=h;break}}return Math.abs(e[0]-this.hw)<6&&this.r.sb(this.f.r.hd(0,1,"com middleness"))&&(e[0]=Math.floor(this.hw)),d[this.r.schoose(this.f.componentChances)](this,e),this.totaldone++,!1}}function x(t){return new a(t)}function M(t,e,h){const s=new u(t,e,h);return function(t){var e=!1;do{e=t.addcomponent()}while(!e);t.cfx.clearRect(t.hw+t.w%2,0,t.w,t.h),t.cfx.scale(-1,1),t.cfx.drawImage(t.cf,0-t.w,0)}(s),s}function m(t){const e=t.getContext("2d");let h=t.width,s=t.height;const i=e.getImageData(0,0,h,s),o=function(t,e,h){for(let s=0;s<h;s++)for(let h=0;h<e;h++)if(t.data[4*(s*e+h)+3]>0)return s;return-1}(i,h,s),a=function(t,e,h){for(let s=h-1;s>=0;s--)for(let h=0;h<e;h++)if(t.data[4*(s*e+h)+3]>0)return s;return-1}(i,h,s),r=function(t,e,h){for(let s=0;s<e;s++)for(let i=0;i<h;i++)if(t.data[4*(i*e+s)+3]>0)return s;return-1}(i,h,s),n=function(t,e,h){for(let s=e-1;s>=0;s--)for(let i=0;i<h;i++)if(t.data[4*(i*e+s)+3]>0)return s;return-1}(i,h,s);if(o<0)return t.width=0,t.height=0,[0,0];h=1+n-r,s=1+a-o;const l=e.getImageData(r,o,h,s);return t.width=h,t.height=s,e.putImageData(l,0,0),[r,o]}function p(t){const e=function(t,e,h,s){const i=Math.floor(t/h),o=Math.floor(e/h),a=[],r=Math.floor(e/(2*o));for(let h=0;h<o;h++){const s=h%2==0?i:i-1,n=Math.floor(h%2==0?t/(2*i):t/i);for(let l=0;l<s;l++)a.push([n+Math.round((l+1*(Math.random()-.5))*t/i),r+Math.round((h+1*(Math.random()-.5))*e/o)])}return a}(t.width,t.height,Math.max(12,Math.floor(Math.min(t.width,t.height)/12))),h=t.getContext("2d"),s=t.width,i=t.height,o=h.getImageData(0,0,s,i),a=e.map((()=>({minX:-1,minY:-1,maxX:-1,maxY:-1,points:[]})));for(let t=0;t<i;t++)for(let h=0;h<s;h++){const i=4*(t*s+h);if(0===o.data[i+3])continue;let r=Math.hypot(e[0][0]-h,e[0][1]-t),n=0;for(let s=1;s<e.length;s++){const i=Math.hypot(e[s][0]-h,e[s][1]-t);i<r&&(r=i,n=s)}const l=a[n];l.minX<0?(l.minX=h,l.minY=t,l.maxX=h,l.maxY=t):(h<l.minX&&(l.minX=h),h>l.maxX&&(l.maxX=h),t<l.minY&&(l.minY=t),t>l.maxY&&(l.maxY=t)),l.points.push([h,t,o.data[i],o.data[i+1],o.data[i+2],o.data[i+3]])}const r=[];for(let t=0;t<a.length;t++){const h=a[t];if(h.minX>-1){const s=h.maxX-h.minX+1,i=h.maxY-h.minY+1,o=document.createElement("canvas");o.width=s,o.height=i;const a=o.getContext("2d"),n=a.createImageData(o.width,o.height);h.points.forEach((t=>{const e=4*((t[1]-h.minY)*s+(t[0]-h.minX));n.data[e]=t[2],n.data[e+1]=t[3],n.data[e+2]=t[4],n.data[e+3]=t[5]})),a.putImageData(n,0,0),r.push({center:e[t],canvas:o,corner:[h.minX,h.minY]})}}return r}function w(t,e,h){const s=1.5+1.5*Math.random(),i=t.center[0]-e/2,o=t.center[1]-h/2,a=Math.sqrt(i*i+o*o),r=a*a,n=a*s;t.translateX=(n-a)*Math.sqrt((r-o*o)/r)*(i>0?1:-1),t.translateY=(n-a)*Math.sqrt((r-i*i)/r)*(o>0?1:-1),t.angle=(720*Math.random()-360)/((Math.random()+2)*t.canvas.width)*10*(Math.PI/180)}function y(t){const e=document.createElement("canvas"),{width:h,height:s}=t;e.width=h,e.height=s;const i=t.getContext("2d"),o=e.getContext("2d"),a=i.getImageData(0,0,h,s),{data:r}=a,{length:n}=r;for(let t=0;t<n;t+=4){const e=r[t+0],h=r[t+1],s=r[t+2];r[t+0]=255-(.393*e+.769*h+.189*s),r[t+1]=255-(.349*e+.686*h+.168*s),r[t+2]=255-(.272*e+.534*h+.131*s)}return o.putImageData(a,0,0),e}function b(t){const e=document.createElement("canvas");e.width=Math.floor(2*K),e.height=Math.floor(2*N);const h=e.getContext("2d"),s=e.width/2-15,i=e.height/2-30;h.setTransform(1.5,0,0,N/K*1.5,0,0);const o=h.createRadialGradient(s,i,10,s,i,30-3*t);return o.addColorStop(0,"transparent"),o.addColorStop(.7,"blue"),o.addColorStop(1,"cyan"),h.fillStyle=o,h.beginPath(),h.arc(s,i,K/2,0,7),h.fill(),m(e),e}function C(t){const e=document.createElement("canvas");e.width=20,e.height=20;const h=e.getContext("2d");var s=h.createRadialGradient(10,10,0,10,10,10);return s.addColorStop(t,"yellow"),s.addColorStop(1,"red"),h.fillStyle=s,h.beginPath(),h.arc(10,10,10,0,7),h.fill(),e}function S(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const h=e.getContext("2d");return h.scale(1,-1),h.drawImage(t,0,0,t.width,-t.height),e}const v=480,T=700,I=240,B=350;let P,A,D=!1,R=!1,k=-1,H=-1,q=-1,E=-1,X=-1,Y=-1,G={},F=!1,L=document.getElementById("a");const O=M(x("piBbgDn4CZqlkqiF"),"ie7jMyCFouoUjkVs",60).cf;m(O);const z=p(O),K=O.width,N=O.height,U=O.getContext("2d").getImageData(0,0,K,N).data;let W,Q,j,Z,J,V=[P,A,K,N,U];!function(t){const e=document.createElement("canvas");e.width=32,e.height=32;const h=e.getContext("2d");let s,i;t.width>t.height?(s=32,i=32*t.height/t.width):(i=32,s=32*t.width/t.height),h.drawImage(t,0,0,s,i);const o=document.createElement("link");o.setAttribute("rel","icon"),o.setAttribute("href",e.toDataURL()),document.head.appendChild(o)}(O);const _=function(){const t=[];for(let e=0;e<5;e++)t.push(b(e));return t}(),$=[],[tt,et]=function(){const t=document.createElement("canvas");t.width=20,t.height=60;const e=t.getContext("2d");return e.fillStyle="yellow",e.beginPath(),e.moveTo(10,60),e.lineTo(20,10),e.arc(10,10,10,0,Math.PI,!0),e.lineTo(10,60),e.fill(),e.strokeStyle="cyan",e.shadowColor="blue",e.globalCompositeOperation="source-atop",e.shadowBlur=4,e.lineWidth=10,e.beginPath(),e.moveTo(10,70),e.lineTo(23,10),e.arc(10,10,13,0,Math.PI,!0),e.lineTo(10,70),e.stroke(),[t,e.getImageData(0,0,t.width,t.height).data]}(),ht=function(){const t=[];for(let e=0;e<9;e++)t.push(C(e/10));for(let e=t.length-2;e>=1;e--)t.push(t[e]);return t}(),st=ht[0].getContext("2d").getImageData(0,0,ht[0].width,ht[0].height).data,[it,ot]=function(){const t=document.createElement("canvas");t.width=60,t.height=60;const e=t.getContext("2d");var h=e.createRadialGradient(30,30,0,30,30,30);return h.addColorStop(.6,"navy"),h.addColorStop(1,"blue"),e.fillStyle=h,e.beginPath(),e.arc(30,30,30,0,7),e.fill(),[t,e.getImageData(0,0,t.width,t.height).data]}();let at,rt,nt,lt=performance.now(),ct=0;const ft=JSON.parse(self.localStorage.pnf_highscores||"false")||[];let dt=-1;const gt=function(){const t=document.createElement("canvas");t.width=100,t.height=100;const e=t.getContext("2d");e.font="bold 20px Helvetica",e.translate(50,50),e.rotate(-Math.PI/2),e.fillStyle="red",e.fillStyle="#fff",e.textAlign="center",e.textBaseline="middle",e.fillText("NEW!",0,0),m(t);const h=document.createElement("canvas");h.width=t.width+10,h.height=t.height+10;const s=h.getContext("2d");return s.fillStyle="red",s.fillRect(0,0,h.width,h.height),s.drawImage(t,5,5),h}();function ut(t){rt+=t,nt=(new Intl.NumberFormat).format(rt)}function xt(){const t=Math.max(400,1e3-25*at);Xt+=qt.si(t,t+400)}let Mt,mt,pt,wt;function yt(t){const e=t[0];m(e);const h=e.getContext("2d").getImageData(0,0,e.width,e.height).data,s=y(e),i=p(e);t[1]=h,t[2]=s,t[3]=i}const bt=[["c4pf4K5xHzu4CyZM","Wl9w64KNQvFNbbbU",50,10,.35,0,[]],["VTjHVRDIYTbXk766","a3QM5c7MnbQlWns3",80,30,.27,0,[]],["1fOXvyryYCvwBWPL","I4xttvPYWxB1So2A",230,80,.2,6,[]],["VsM4qdcBSiuCPDGJ","q4D72OvJMb23kSZC",60,20,.4,0,[]],["l4pyu8yF0mt84Q4u","jPU5GcKNpf2JMgoG",100,40,.35,0,[[B]]],["NMp3mtsPHIwzMKYk","dBzvSKo7wpema3S5",220,90,.22,9,[]],["o67yOby6izpasGgo","fyKKupDEId96qQHu",70,20,.5,0,[[B]]],["IU7xqL8UqZIXJQDQ","aVBO8buAfBbQ4DOY",100,40,.35,0,[[B,6]]],["LP6kUeGMn7S5xZzi","p5O7jAQK67mDULTD",230,100,.25,14,[]],["SsSvCKpjLVTGITYH","aOEjI2Owpqpl06ex",65,30,.5,0,[[B]]],["AGUwhB1E94wgKe49","pwUtokX7oS7ZKFK1",110,50,.35,6,[[B,6]]],["qRF6GA3xnzX0lMcH","RIdNudvB6T2ro7C3",240,120,.3,22,[]]];function Ct(t,e){const h=t[0]-t[2]/2<e[0]-e[2]/2?[t,e]:[e,t],s=t[1]-t[3]/2<e[1]-e[3]/2?[t,e]:[e,t];if(h[0][0]+h[0][2]/2>h[1][0]-h[1][2]/2&&s[0][1]+s[0][3]/2>s[1][1]-s[1][3]/2){const i=Math.floor(h[1][0]-h[1][2]/2),o=Math.floor(s[1][1]-s[1][3]/2),a=Math.floor(Math.min(h[0][0]+h[0][2]/2,h[1][0]+h[1][2]/2))-i,r=Math.floor(Math.min(s[0][1]+s[0][3]/2,s[1][1]+s[1][3]/2))-o,n=i-Math.floor(t[0]-t[2]/2),l=o-Math.floor(t[1]-t[3]/2),c=i-Math.floor(e[0]-e[2]/2),f=o-Math.floor(e[1]-e[3]/2);for(let h=0;h<r;h++)for(let s=0;s<a;s++)if(t[4][4*((l+h)*t[2]+n+s)+3]>0&&e[4][4*((f+h)*e[2]+c+s)+3]>0)return!0}return!1}const St=[["F","orange",t=>{j=t+6500}],["S","cyan",()=>{J++}],["B","red",t=>{Z=t+1e3,Xt+=1500}]];class vt{constructor(t,e,h,s){this.x=t,this.y=e,this.type=h,this.lastTime=s,this.frame=0,this.alwaysOnTop=!0}run(t,e,h){if(this.y+=5*(h-this.lastTime)/32,this.frame=(this.frame+1)%50,!W&&Ct(V,[this.x,this.y,it.width,it.height,ot]))return St[this.type][2](h),!1;if(this.y-Math.floor(it.height/2)>T)return!1;this.lastTime=h,e.save(),e.translate(this.x,this.y),e.drawImage(it,-Math.floor(it.width/2),-Math.floor(it.height/2)),e.textAlign="center",e.textBaseline="top";let s=65;s+=this.frame<25?this.frame:50-this.frame,e.font="700 "+Math.floor(s/2)+"px Helvetica";const i=e.measureText(St[this.type][0]),o=i.actualBoundingBoxDescent-i.actualBoundingBoxAscent;return e.fillStyle=St[this.type][1],e.fillText(St[this.type][0],0,-Math.floor(o/2)),e.restore(),!0}}class Tt{constructor(t,e,h){this.x=t,this.y=e,this.lastTime=h,this.power=10}run(t,e,h){this.y-=20*(h-this.lastTime)/32;const s=[this.x,this.y,tt.width,tt.height,et];for(let e=0;e<t.length;e++){const i=t[e];if(Ct(s,i.hitBox))return i.hit(this.power,h),!1}return!(this.y+Math.floor(tt.height/2)<0||(this.lastTime=h,e.drawImage(tt,this.x-Math.floor(tt.width/2),this.y-Math.floor(tt.height/2)),0))}}class It{constructor(t,e,h,s,i){this.time=i,this.center=t.center,this.canvas=t.canvas,this.corner=t.corner,this.translateX=t.translateX,this.translateY=t.translateY,this.angle=t.angle,this.shipX=e,this.shipY=h,this.duration=s}run(t,e,h){const s=h-this.time;if(s>this.duration)return!1;const i=this.shipX+this.center[0]+this.translateX*Math.min(s,this.duration)/this.duration,o=this.shipY+this.center[1]+this.translateY*Math.min(s,this.duration)/this.duration;return e.save(),e.globalAlpha=1-(Math.min(s,this.duration)/this.duration)**2,e.translate(i,o),e.rotate(this.angle*Math.min(s,this.duration)/this.duration),e.drawImage(this.canvas,this.corner[0]-this.center[0],this.corner[1]-this.center[1]),e.restore(),!0}}class Bt{constructor(t,e,h,s,i,o){this.width=ht[0].width,this.height=ht[0].height,this.x=t,this.y=e;const a=Math.sqrt((h-t)**2+(s-e)**2);this.xFactor=(h-t)/a,this.yFactor=(s-e)/a,this.lastTime=o,this.speed=i,this.frame=0,this.alwaysOnTop=!0,this.updateHitBox()}run(t,e,h){if(Z>h)return!1;const s=h-this.lastTime;if(this.y+=s*this.speed*this.yFactor,this.x+=s*this.speed*this.xFactor,this.updateHitBox(),Ct(V,this.hitBox)){if(J)return J--,!1;W=!0}return!(this.y-Math.floor(this.height/2)>T||this.y+Math.floor(this.height/2)<0||this.x-Math.floor(this.width/2)>v||this.x+Math.floor(this.width/2)<0||(this.lastTime=h,this.frame=(this.frame+1)%ht.length,e.drawImage(ht[this.frame],this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height),0))}updateHitBox(){this.hitBox=[this.x,this.y,this.width,this.height,st]}}function Pt(t,e,h,s,i,o){const a=[];for(let r=0;r<t;r++){const n=s+2*r*Math.PI/t;a.push(new Bt(e,h,e+Math.round(100*Math.cos(n)),h+Math.round(100*Math.sin(n)),i,o))}return a}class At{constructor(t,e,h,s,i,o,a,r,n,l,c,f){this.fireAngle=qt.sd(0,2*Math.PI),this.canvas=t,this.mask=e,this.hitCanvas=h,this.width=t.width,this.height=t.height,this.health=r,this.x=i,this.y=o,this.lastTime=f,this.hitTime=0,this.destroyedSprites=s,this.speed=a,this.points=n,this.deathBullets=l,this.fireSequences=c,this.updateHitBox()}run(t,e,h){const s=this.y;let i=!1;if(this.health<=0||Z>h?i=!0:(this.y+=(h-this.lastTime)*this.speed,this.updateHitBox(),Ct(V,this.hitBox)&&(J?(J--,i=!0):W=!0)),i)return ut(this.points),(this.deathBullets>0?Pt(this.deathBullets,this.x,this.y+Math.round(17*this.speed),this.fireAngle,.45,h):[]).concat(this.destroyedSprites.map((t=>(w(t,this.width,this.height),new It(t,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),500,h)))));if(this.y-Math.floor(this.height/2)>T)return!1;this.lastTime=h;const o=h-this.hitTime;let a=0;if(o<400&&(a=(400-o)/400),e.save(),e.drawImage(this.canvas,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height),a>0&&(e.globalAlpha=a,e.drawImage(this.hitCanvas,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height)),e.restore(),!W)for(let t=0;t<this.fireSequences.length;t++){const e=this.fireSequences[t][0];if(s<e&&this.y>e){const e=this.fireSequences[t][1],s=this.y+Math.round(17*this.speed);return e?[this,...Pt(e,this.x,s,this.fireAngle,.3,h)]:[this,new Bt(this.x,s,P,A,.3,h)]}}return!0}updateHitBox(){this.hitBox=[this.x,this.y,this.width,this.height,this.mask]}hit(t,e){this.hitTime=e,this.health-=t}}class Dt{constructor(t,e){this.state=0,this.nextState=e+2e3,this.health=Number.MAX_SAFE_INTEGER,this.lastTime=e,this.width=Mt.width,this.height=Mt.height,this.x=I,this.y=-this.height/2,this.direction=0,this.hitTime=0,this.level=t,this.updateHitBox()}run(t,e,h){let s=!1;if(this.health<=0)s=!0;else{const t=h-this.lastTime;0===this.state?h>this.nextState&&(this.state=1):1===this.state?(this.y+=.15*t,this.y>150&&(this.y=150,this.health=100+250*this.level,this.state=2,this.nextBullet=h,this.bulletCount=0)):0===this.direction?(this.x+=.1*t,this.x+Math.floor(this.width/2)>v&&(this.x=v-Math.floor(this.width/2),this.direction=1)):(this.x-=.1*t,this.x-Math.floor(this.width/2)<0&&(this.x=Math.floor(this.width/2),this.direction=0)),this.updateHitBox(),Ct(V,this.hitBox)&&(W=!0)}if(s)return ut(500*at),Lt=!1,Yt=h+1e4,Xt=500+h,xt(),Gt=500+h,wt.map((t=>(w(t,this.width,this.height),new It(t,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),500,h))));this.lastTime=h;const i=h-this.hitTime;let o=0;if(i<400&&(o=(400-i)/400),e.save(),e.drawImage(Mt,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height),o>0&&(e.globalAlpha=o,e.drawImage(pt,this.x-Math.floor(this.width/2),this.y-Math.floor(this.height/2),this.width,this.height)),e.restore(),!W&&2===this.state&&this.nextBullet<h){const t=[];if(this.bulletCount<5*this.level){let e,s;switch(Math.floor(this.bulletCount/this.level)){case 0:e=28,s=119;break;case 1:e=42,s=123;break;case 2:e=108,s=94;break;case 3:e=121,s=80;break;default:e=143,s=50}t.push(new Bt(this.x-e,this.y+s,this.x-e,this.y+s+100,.5,h)),t.push(new Bt(this.x+e,this.y+s,this.x+e,this.y+s+100,.5,h))}else t.push(new Bt(this.x,this.y+125,P,A,.3,h));return this.bulletCount++,this.bulletCount>=10*this.level?(this.bulletCount=0,this.nextBullet=h+800):this.nextBullet=this.bulletCount>5*this.level?h+200:this.bulletCount===5*this.level?h+800:this.bulletCount%this.level?h+180:h+500,[this,...t]}return!0}updateHitBox(){this.hitBox=[this.x,this.y,this.width,this.height,mt]}hit(t,e){this.hitTime=e,this.health-=t}}let Rt,kt,Ht,qt,Et,Xt,Yt,Gt,Ft,Lt,Ot,zt=5;self.onload=e=>{L.width=v,L.height=T,L.getContext("2d"),requestAnimationFrame((function e(h){(function(e){switch(ct){case 0:case 1:!function(e){const h=L.getContext("2d");h.fillStyle="#000",h.fillRect(0,0,v,T),h.fillStyle="#fff";let s=(e-lt)/3e3;h.save();for(let t=200;t--;){let e=50/(6-(s+t/13)%6);h.globalAlpha=Math.min(e/100,1),h.beginPath(),h.arc(Math.cos(t)*e+I,Math.sin(t*t)*e+B,e/200,0,7),h.fill()}if(h.restore(),h.textBaseline="middle",h.textAlign="center",1===ct){if(0===ft.length)h.font="bold 40px Helvetica",h.fillText("PLANET NOT FOUND",I,B);else{h.font="bold 30px Helvetica",h.fillText("HIGH SCORES",I,100),h.save(),h.textAlign="start",h.textBaseline="top";for(let t=0;t<ft.length;t++){t===dt?(h.save(),h.translate(90,185+80*t),h.drawImage(gt,-Math.floor(gt.width/2),-Math.floor(gt.height/2)),h.restore(),h.fillStyle="gold"):h.fillStyle="#fff";const e=Intl.NumberFormat().format(ft[t][0]),s=new Date(ft[t][1]).toLocaleString();h.font="50px Helvetica",h.fillText(t+1+"",115,160+80*t),h.font="60px Helvetica",h.fillText("{",145,150+80*t),h.font="25px Helvetica",h.fillText(e+" points",170,160+80*t),h.font="15px Helvetica",h.fillText(s,170,190+80*t)}h.restore()}h.font="20px Helvetica",h.fillText("<Press anywhere or any key to play>",I,670),D||F?R||(ct=2,at=0,qt=new t("enemy"),Et=new t("powerup"),Xt=1e3,Yt=5e3,Gt=9e3,Ft=0,Ht=0,Rt=[],kt=[],lt=performance.now(),Ot=performance.now(),rt=0,ut(0),W=!1,P=I,A=630,j=0,Z=0,J=1,Lt=!1,dt=-1):R=!1}else if(h.font="italic 30px Helvetica",h.fillText("Loadingâ€¦",I,B),Mt)if($.length<bt.length)$.push(function(t,e,h,...s){return[S(M(x(t),e,h).cf),void 0,void 0,void 0,...s]}(...bt[$.length]));else{let t=!0;for(let e=0;t&&e<$.length;e++)$[e][1]||(t=!1,yt($[e]));t&&(ct=1)}else Mt=S(M(x("HYj7ADLjQr6icLtO"),"CdiB9N2ZoQWuAxur",270).cf),m(Mt),pt=y(Mt),wt=p(Mt),mt=Mt.getContext("2d").getImageData(0,0,Mt.width,Mt.height).data}(e);break;case 2:!function(t){const e=t-Ot;if(Ot=t,e>160)return lt+=e,void(G={});if(!W){const t=.6*e,h=G.ArrowUp||G.KeyW,s=G.ArrowDown||G.KeyS,i=G.ArrowLeft||G.KeyA,o=G.ArrowRight||G.KeyD;if(h||s||i||o){const e=(h||s)&&(i||o)?Math.sqrt(t**2/2):t;h&&(A-=e),s&&(A+=e),i&&(P-=e),o&&(P+=e),X=P,Y=A}else{let e=X-P,h=Y-A;const s=Math.sqrt(e**2+h**2);s<t?(P=X,A=Y):(P+=e/s*t,A+=h/s*t)}P-Math.floor(K/2)<0?P=Math.floor(K/2):P+Math.floor(K/2)>v&&(P=v-Math.floor(K/2)),A-Math.floor(N/2)<0?A=Math.floor(N/2):A+Math.floor(N/2)>T&&(A=T-Math.floor(N/2)),V=[P,A,K,N,U]}const h=L.getContext("2d");let s;h.fillStyle="#000",h.fillRect(0,0,v,T),h.fillStyle="#777";for(let e=100;e--;h.beginPath(),h.arc(Math.floor(-60*(100-e)*(P-K/2)/(100*(v-K)))+102797*(1+Math.sin(s))*e%540,T*(Math.tan(e/9)+s*(t-lt)/3e3)%T,2*s,0,7),h.fill())s=149/(3*e+199);const i=W,o=[],a=[],r=[];function n(e){const s=e.run(kt,h,t-lt);"boolean"==typeof s?s&&(e.alwaysOnTop?a.push(e):o.push(e),e.hit&&r.push(e)):Array.isArray(s)&&s.forEach((t=>{e===t?s&&(e.alwaysOnTop?a.push(e):o.push(e),e.hit&&r.push(e)):n(t)}))}if(Rt.forEach(n),!i&&W&&(Q=t-lt,z.map((e=>(w(e,K,N),new It(e,P-Math.floor(K/2),A-Math.floor(N/2),1500,t-lt)))).forEach(n)),Rt=o.concat(a),kt=r,h.fillStyle="#fff",h.textAlign="center",W)h.save(),h.globalAlpha=Math.min(1,(t-lt-Q)/2e3),h.textBaseline="middle",h.font="40px Helvetica",h.fillText("Game Over",I,B),h.restore();else{if(J){const t=_[Math.min(J-1,_.length-1)];h.drawImage(t,P-Math.floor(t.width/2),A-Math.floor(t.height/2)+5)}h.drawImage(O,P-Math.floor(K/2),A-Math.floor(N/2))}Z>t-lt&&(h.save(),h.globalAlpha=(Z-t+lt)/1e3,h.fillStyle="#fff",h.fillRect(0,0,v,T),h.restore()),h.textBaseline="top",h.font="16px Helvetica",h.fillText(nt,I,5);const l=j>t-lt;if(!W&&Ht+(l?100:200)<t-lt&&(zt=-zt,Rt.push(new Tt(P+(l?zt:0),A-Math.floor(N/2),t-lt)),Ht=Math.max(t-lt)),Yt<t-lt&&!Lt&&(at++,at%5?Yt=t-lt+1e4:(Lt=!0,Rt.push(new Dt(Math.floor(at/5),t-lt)))),Gt<t-lt&&!Lt&&(Rt.push(new vt(Et.si(30,450),Math.floor(-it.height/2),Ft,t-lt)),Ft=(Ft+1)%St.length,Gt=t-lt+9e3),Xt<t-lt&&!Lt){const e=qt.si(Math.min(Math.max(at-2,0),$.length-3),Math.min(at,$.length-1)),[h,s,i,o,a,r,n,l]=$[e];Rt.push(new At(h,s,i,o,qt.si(30,450),Math.floor(-h.height/2),r,a,50*(e+1),n,l,t-lt)),xt()}W&&Q+3500<t-lt&&(function(){if(rt){const t=[rt,Date.now()];ft.push(t),ft.sort(((t,e)=>{const h=e[0]-t[0];return 0===h?e[1]-t[1]:h})),ft.length=Math.min(ft.length,5),dt=ft.indexOf(t),self.localStorage.pnf_highscores=JSON.stringify(ft)}}(),ct=1,R=D)}(e)}F=!1})(h),requestAnimationFrame(e)}))};let Kt=t=>{let e,h,s,i;L.offsetWidth/L.offsetHeight>.6857142857142857?(h=0,i=L.offsetHeight,s=i*v/T,e=Math.floor(L.offsetWidth-s)/2):(e=0,s=L.offsetWidth,i=s*T/v,h=Math.floor(L.offsetHeight-i)/2);let o={};return o=t.changedTouches?t.changedTouches[0]:t,[Math.floor((o.pageX-e)*v/s),Math.floor((o.pageY-h)*T/i)]};self.ontouchstart=self.onpointerdown=t=>{t.preventDefault(),D=!0,[k,H]=Kt(t),X=k,Y=H},self.ontouchmove=self.onpointermove=t=>{t.preventDefault(),[X,Y]=Kt(t)},self.ontouchend=self.onpointerup=t=>{t.preventDefault(),D=!1,[q,E]=Kt(t)},self.onkeydown=t=>{F=!0,G[t.code]=1,t.preventDefault()},self.onkeyup=t=>{G[t.code]=0,t.preventDefault()}}();
